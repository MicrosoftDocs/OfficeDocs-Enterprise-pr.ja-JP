---
title: Office 365 の分離とアクセス制御 (Office 365)
ms.author: robmazz
author: robmazz
manager: laurawi
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.collection:
- Strat_O365_IP
- M365-security-compliance
- SPO_Content
f1.keywords:
- NOCSH
description: '概要: Office 365 のさまざまなアプリケーションでの分離とアクセス制御について説明します。'
ms.openlocfilehash: 2cf98480a2a3f5d202198c9056ecb46d281e1a3e
ms.sourcegitcommit: 99411927abdb40c2e82d2279489ba60545989bb1
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/07/2020
ms.locfileid: "41844408"
---
# <a name="isolation-and-access-control-in-office-365"></a><span data-ttu-id="649bb-103">Office 365 での分離とアクセス制御</span><span class="sxs-lookup"><span data-stu-id="649bb-103">Isolation and Access Control in Office 365</span></span>

<span data-ttu-id="649bb-104">Azure Active Directory と Office 365 では、非常に複雑なデータモデルが使用されています。これには、数百のエンティティ、数千件の関係、および数万の属性が含まれています。</span><span class="sxs-lookup"><span data-stu-id="649bb-104">Azure Active Directory and Office 365 use a highly complex data model that includes tens of services, hundreds of entities, thousands of relationships, and tens of thousands of attributes.</span></span> <span data-ttu-id="649bb-105">高レベルでは、Azure Active Directory とサービスディレクトリは、状態ベースのレプリケーションプロトコルを使用して同期されたテナントと受信者のコンテナーです。</span><span class="sxs-lookup"><span data-stu-id="649bb-105">At a high level, Azure Active Directory and the service directories are the containers of tenants and recipients kept in sync using state-based replication protocols.</span></span> <span data-ttu-id="649bb-106">Azure Active Directory 内に保持されているディレクトリ情報に加えて、各サービスワークロードには独自のディレクトリサービスインフラストラクチャがあります。</span><span class="sxs-lookup"><span data-stu-id="649bb-106">In addition to the directory information held within Azure Active Directory, each of the service workloads have their own directory services infrastructure.</span></span>
 
![Office 365 テナントデータ同期](media/office-365-isolation-tenant-data-sync.png)

<span data-ttu-id="649bb-108">このモデルでは、ディレクトリデータの単一のソースはありません。</span><span class="sxs-lookup"><span data-stu-id="649bb-108">Within this model, there is no single source of directory data.</span></span> <span data-ttu-id="649bb-109">特定のシステムは個別のデータを所有していますが、すべてのデータを保持する単一のシステムはありません。</span><span class="sxs-lookup"><span data-stu-id="649bb-109">Specific systems own individual pieces of data, but no single system holds all the data.</span></span> <span data-ttu-id="649bb-110">Office 365 サービスは、このデータモデルの Azure Active Directory と連携します。</span><span class="sxs-lookup"><span data-stu-id="649bb-110">Office 365 services cooperate with Azure Active Directory in this data model.</span></span> <span data-ttu-id="649bb-111">Azure Active Directory は共有データの "真実のシステム" です。これは、通常、すべてのサービスで使用される小さなデータおよび静的データです。</span><span class="sxs-lookup"><span data-stu-id="649bb-111">Azure Active Directory is the "system of truth" for shared data, which is typically small and static data used by every service.</span></span> <span data-ttu-id="649bb-112">Office 365 および Azure Active Directory 内で使用されているフェデレーションモデルは、データの共有ビューを提供します。</span><span class="sxs-lookup"><span data-stu-id="649bb-112">The federated model used within Office 365 and Azure Active Directory provides the shared view of the data.</span></span>

<span data-ttu-id="649bb-113">Office 365 は、物理ストレージと Azure クラウドストレージの両方を使用します。</span><span class="sxs-lookup"><span data-stu-id="649bb-113">Office 365 uses both physical storage and Azure cloud storage.</span></span> <span data-ttu-id="649bb-114">Exchange Online (Exchange Online Protection を含む) および Skype for Business は、お客様のデータに独自のストレージを使用します。</span><span class="sxs-lookup"><span data-stu-id="649bb-114">Exchange Online (including Exchange Online Protection) and Skype for Business use their own storage for customer data.</span></span> <span data-ttu-id="649bb-115">SharePoint Online は、SQL Server ストレージと Azure ストレージの両方を使用するため、ストレージレベルで顧客データをさらに分離する必要があります。</span><span class="sxs-lookup"><span data-stu-id="649bb-115">SharePoint Online uses both SQL Server storage and Azure Storage, hence the need for additional isolation of customer data at the storage level.</span></span>

## <a name="exchange-online"></a><span data-ttu-id="649bb-116">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="649bb-116">Exchange Online</span></span>

<span data-ttu-id="649bb-117">Exchange Online は、メールボックス内に顧客データを格納します。</span><span class="sxs-lookup"><span data-stu-id="649bb-117">Exchange Online stores customer data within mailboxes.</span></span> <span data-ttu-id="649bb-118">メールボックスは、メールボックスデータベースと呼ばれる拡張記憶域エンジン (ESE) データベース内でホストされます。</span><span class="sxs-lookup"><span data-stu-id="649bb-118">Mailboxes are hosted within Extensible Storage Engine (ESE) databases called mailbox databases.</span></span> <span data-ttu-id="649bb-119">これには、ユーザーメールボックス、リンクされたメールボックス、共有メールボックス、およびパブリックフォルダーメールボックスが含まれます。</span><span class="sxs-lookup"><span data-stu-id="649bb-119">This includes user mailboxes, linked mailboxes, shared mailboxes, and public folder mailboxes.</span></span> <span data-ttu-id="649bb-120">ユーザーメールボックスには、会話の履歴など、保存された Skype for Business コンテンツが含まれています。</span><span class="sxs-lookup"><span data-stu-id="649bb-120">User mailboxes include saved Skype for Business content, such as conversation histories.</span></span>

<span data-ttu-id="649bb-121">ユーザーメールボックスのコンテンツには次のものが含まれます。</span><span class="sxs-lookup"><span data-stu-id="649bb-121">User mailbox content includes:</span></span>

- <span data-ttu-id="649bb-122">メールと電子メールの添付ファイル</span><span class="sxs-lookup"><span data-stu-id="649bb-122">Emails and email attachments</span></span>
- <span data-ttu-id="649bb-123">予定表と空き時間情報</span><span class="sxs-lookup"><span data-stu-id="649bb-123">Calendaring and free/busy information</span></span>
- <span data-ttu-id="649bb-124">連絡先</span><span class="sxs-lookup"><span data-stu-id="649bb-124">Contacts</span></span>
- <span data-ttu-id="649bb-125">タスク</span><span class="sxs-lookup"><span data-stu-id="649bb-125">Tasks</span></span>
- <span data-ttu-id="649bb-126">メモ</span><span class="sxs-lookup"><span data-stu-id="649bb-126">Notes</span></span>
- <span data-ttu-id="649bb-127">グループ</span><span class="sxs-lookup"><span data-stu-id="649bb-127">Groups</span></span>
- <span data-ttu-id="649bb-128">推論データ</span><span class="sxs-lookup"><span data-stu-id="649bb-128">Inference data</span></span>

<span data-ttu-id="649bb-129">Exchange Online 内の各メールボックスデータベースには、複数のテナントからのメールボックスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="649bb-129">Each mailbox database within Exchange Online contains mailboxes from multiple tenants.</span></span> <span data-ttu-id="649bb-130">認証コードは、テナント内などの各メールボックスをセキュリティで保護します。</span><span class="sxs-lookup"><span data-stu-id="649bb-130">An authorization code secures each mailbox, including within a tenancy.</span></span> <span data-ttu-id="649bb-131">既定では、割り当てられたユーザーのみがメールボックスにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="649bb-131">By default, only the assigned user has access to a mailbox.</span></span> <span data-ttu-id="649bb-132">メールボックスをセキュリティで保護するアクセス制御リスト (ACL) には、テナントレベルで Azure Active Directory によって認証された id が含まれています。</span><span class="sxs-lookup"><span data-stu-id="649bb-132">The access control list (ACL) that secures a mailbox contains an identity authenticated by Azure Active Directory at the tenant level.</span></span> <span data-ttu-id="649bb-133">各テナントのメールボックスは、テナントの認証プロバイダーに対して認証された id に制限されます。これには、そのテナントのユーザーのみが含まれます。</span><span class="sxs-lookup"><span data-stu-id="649bb-133">The mailboxes for each tenant are limited to identities authenticated against the tenant's authentication provider, which includes only users from that tenant.</span></span> <span data-ttu-id="649bb-134">テナント a で明示的に承認されていない限り、テナント内のコンテンツは、テナント B のユーザーによって取得されることはできません。</span><span class="sxs-lookup"><span data-stu-id="649bb-134">Content in tenant A cannot in any way be obtained by users in tenant B, unless explicitly approved by tenant A.</span></span>

## <a name="skype-for-business"></a><span data-ttu-id="649bb-135">Skype for Business</span><span class="sxs-lookup"><span data-stu-id="649bb-135">Skype for Business</span></span>

<span data-ttu-id="649bb-136">Skype for Business は、さまざまな場所にデータを格納します。</span><span class="sxs-lookup"><span data-stu-id="649bb-136">Skype for Business stores data in various places:</span></span>

- <span data-ttu-id="649bb-137">接続エンドポイント、テナント Id、ダイヤルプラン、ローミング設定、プレゼンス状態、連絡先リストなどを含むユーザーおよびアカウント情報は、Skype for Business Active Directory サーバー、およびさまざまな Skype for Business データベースサーバーに格納されます。</span><span class="sxs-lookup"><span data-stu-id="649bb-137">User and account information, which includes connection endpoints, tenant IDs, dial plans, roaming settings, presence state, contact lists, etc., is stored in the Skype for Business Active Directory servers, and in various Skype for Business database servers.</span></span> <span data-ttu-id="649bb-138">ユーザーが両方の製品に対して有効になっている場合、またはユーザーがいない場合、Skype for Business サーバーでユーザーの Exchange Online メールボックスに連絡先リストが格納されます。</span><span class="sxs-lookup"><span data-stu-id="649bb-138">Contact lists are stored in the user's Exchange Online mailbox if the user is enabled for both products, or on Skype for Business servers if the user is not.</span></span> <span data-ttu-id="649bb-139">Skype for Business データベースサーバーはテナントごとにパーティション分割されませんが、データのマルチテナント分離は、役割ベースのアクセス制御 (RBAC) によって適用されます。</span><span class="sxs-lookup"><span data-stu-id="649bb-139">Skype for Business database servers are not partitioned per-tenant, but multi-tenancy isolation of data is enforced through role-based access control (RBAC).</span></span>
- <span data-ttu-id="649bb-140">会議コンテンツとアップロードデータは、分散ファイルシステム (DFS) 共有に保存されます。</span><span class="sxs-lookup"><span data-stu-id="649bb-140">Meeting content and uploaded data is stored on Distributed File System (DFS) shares.</span></span> <span data-ttu-id="649bb-141">このコンテンツは、有効になっている場合に Exchange Online にアーカイブすることもできます。</span><span class="sxs-lookup"><span data-stu-id="649bb-141">This content can also be archived in Exchange Online if enabled.</span></span> <span data-ttu-id="649bb-142">DFS 共有は、テナントごとにパーティション分割されません。</span><span class="sxs-lookup"><span data-stu-id="649bb-142">The DFS shares are not partitioned per-tenant.</span></span> <span data-ttu-id="649bb-143">コンテンツは Acl を使用してセキュリティ保護され、マルチテナントは RBAC によって適用されます。</span><span class="sxs-lookup"><span data-stu-id="649bb-143">the content is secured with ACLs and multi-tenancy is enforced through RBAC.</span></span>
- <span data-ttu-id="649bb-144">通話履歴、IM セッション、アプリケーション共有、IM 履歴などのアクティビティ履歴である通話詳細レコードは、Exchange Online にも保存できますが、ほとんどの通話詳細レコードは、通話詳細記録 (CDR) サーバーに一時的に格納されます。</span><span class="sxs-lookup"><span data-stu-id="649bb-144">Call detail records, which are the activity history, such as call history, IM sessions, application sharing, IM history, etc., can also be stored in Exchange Online, but most call detail records are temporarily stored on call detail record (CDR) servers.</span></span> <span data-ttu-id="649bb-145">コンテンツはテナントごとにパーティション分割されませんが、マルチテナントは RBAC を介して適用されます。</span><span class="sxs-lookup"><span data-stu-id="649bb-145">Content is not partitioned per tenant, but multi-tenancy is enforced through RBAC.</span></span>

## <a name="sharepoint-online"></a><span data-ttu-id="649bb-146">SharePoint Online</span><span class="sxs-lookup"><span data-stu-id="649bb-146">SharePoint Online</span></span>

<span data-ttu-id="649bb-147">SharePoint Online には、データの分離を提供する独立したメカニズムがいくつかあります。</span><span class="sxs-lookup"><span data-stu-id="649bb-147">SharePoint Online has several independent mechanisms that provide data isolation.</span></span> <span data-ttu-id="649bb-148">オブジェクトをアプリケーションデータベース内の抽象化されたコードとして格納します。</span><span class="sxs-lookup"><span data-stu-id="649bb-148">It stores objects as abstracted code within application databases.</span></span> <span data-ttu-id="649bb-149">たとえば、ユーザーがファイルを SharePoint Online にアップロードすると、ファイルは分解され、アプリケーションコードに変換され、複数のデータベースにわたって複数のテーブルに格納されます。</span><span class="sxs-lookup"><span data-stu-id="649bb-149">For example, when a user uploads a file to SharePoint Online, the file is disassembled, translated into application code, and stored in multiple tables across multiple databases.</span></span>

<span data-ttu-id="649bb-150">ユーザーがデータが格納されているストレージに直接アクセスできた場合、そのコンテンツは、手動または SharePoint Online 以外のシステムによって解釈されることはありません。</span><span class="sxs-lookup"><span data-stu-id="649bb-150">If a user could gain direct access to the storage containing the data, the content is not interpretable to a human or any system other than SharePoint Online.</span></span> <span data-ttu-id="649bb-151">これらのメカニズムには、セキュリティアクセス制御およびプロパティが含まれます。</span><span class="sxs-lookup"><span data-stu-id="649bb-151">These mechanisms include security access control and properties.</span></span> <span data-ttu-id="649bb-152">すべての SharePoint Online リソースは、認証コードと、テナントの内部を含む RBAC ポリシーによって保護されます。</span><span class="sxs-lookup"><span data-stu-id="649bb-152">All SharePoint Online resources are secured by the authorization code and RBAC policy, including within a tenancy.</span></span> <span data-ttu-id="649bb-153">リソースを保護するアクセス制御リスト (ACL) には、テナントレベルで認証された id が含まれています。</span><span class="sxs-lookup"><span data-stu-id="649bb-153">The access control list (ACL) that secures a resource contains an identity authenticated at the tenant level.</span></span> <span data-ttu-id="649bb-154">テナントの SharePoint Online データは、テナントの認証プロバイダによって認証された id に限定されます。</span><span class="sxs-lookup"><span data-stu-id="649bb-154">SharePoint Online data for a tenant is limited to identities authenticated by the authentication provider for the tenant.</span></span>

<span data-ttu-id="649bb-155">Acl に加えて、認証プロバイダ (テナント固有の Azure Active Directory) を指定するテナントレベルのプロパティは一度書き込まれます。一度設定すると、設定後に変更することはできません。</span><span class="sxs-lookup"><span data-stu-id="649bb-155">In addition to the ACLs, a tenant level property that specifies the authentication provider (which is the tenant-specific Azure Active Directory), is written once and cannot be changed once set.</span></span> <span data-ttu-id="649bb-156">テナントに対して認証プロバイダのテナントプロパティを設定すると、テナントに公開されている Api を使用して変更することはできません。</span><span class="sxs-lookup"><span data-stu-id="649bb-156">Once the authentication provider tenant property has been set for a tenant, it cannot be changed using any APIs exposed to a tenant.</span></span>

<span data-ttu-id="649bb-157">一意の*SubscriptionId*が各テナントに使用されます。</span><span class="sxs-lookup"><span data-stu-id="649bb-157">A unique *SubscriptionId* is used for each tenant.</span></span> <span data-ttu-id="649bb-158">すべての顧客サイトはテナントによって所有され、テナントに固有の*SubscriptionId*が割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="649bb-158">All customer sites are owned by a tenant and assigned a *SubscriptionId* unique to the tenant.</span></span> <span data-ttu-id="649bb-159">サイトの*SubscriptionId*プロパティは、一度だけ書き込まれ、永続的なものになります。</span><span class="sxs-lookup"><span data-stu-id="649bb-159">The *SubscriptionId* property on a site is written once and is permanent.</span></span> <span data-ttu-id="649bb-160">テナントに割り当てられた後は、サイトを別のテナントに移動することはできません。</span><span class="sxs-lookup"><span data-stu-id="649bb-160">Once assigned to a tenant, a site cannot be moved to a different tenant.</span></span> <span data-ttu-id="649bb-161">*SubscriptionId*は、認証プロバイダーのセキュリティスコープを作成するために使用されるキーで、テナントに関連付けられています。</span><span class="sxs-lookup"><span data-stu-id="649bb-161">The *SubscriptionId* is the key used to create the security scope for the authentication provider and is tied to the tenant.</span></span>

<span data-ttu-id="649bb-162">SharePoint Online は、SQL Server と、コンテンツメタデータストレージ用の Azure ストレージを使用します。</span><span class="sxs-lookup"><span data-stu-id="649bb-162">SharePoint Online uses SQL Server and Azure Storage for content metadata storage.</span></span> <span data-ttu-id="649bb-163">コンテンツストアのパーティションキーは SQL での*SiteId*です。</span><span class="sxs-lookup"><span data-stu-id="649bb-163">The partition key for the content store is *SiteId* in SQL.</span></span> <span data-ttu-id="649bb-164">SQL クエリを実行している場合、SharePoint Online はテナントレベルの*SubscriptionId*チェックの一部として確認された*SiteId*を使用します。</span><span class="sxs-lookup"><span data-stu-id="649bb-164">When running a SQL query, SharePoint Online uses a *SiteId* verified as part of a tenant-level *SubscriptionId* check.</span></span>

<span data-ttu-id="649bb-165">SharePoint Online は、暗号化されたファイルコンテンツを Microsoft Azure blob に格納します。</span><span class="sxs-lookup"><span data-stu-id="649bb-165">SharePoint Online stores encrypted file content in Microsoft Azure blobs.</span></span> <span data-ttu-id="649bb-166">各 SharePoint Online ファームには独自の Microsoft Azure アカウントがあり、Azure に保存されているすべての blob は、SQL コンテンツストアに格納されているキーを使用して個別に暗号化されます。</span><span class="sxs-lookup"><span data-stu-id="649bb-166">Each SharePoint Online farm has its own Microsoft Azure account and all the blobs saved in Azure are encrypted individually with a key stored in the SQL content store.</span></span> <span data-ttu-id="649bb-167">認証層によってコードで保護されており、エンドユーザーに直接公開されていない暗号化キー。</span><span class="sxs-lookup"><span data-stu-id="649bb-167">The encryption key protected in code by the authorization layer and not exposed directly to the end user.</span></span> <span data-ttu-id="649bb-168">SharePoint Online はリアルタイム監視を使用して、HTTP 要求が複数のテナントに対してデータを読み書きするタイミングを検出します。</span><span class="sxs-lookup"><span data-stu-id="649bb-168">SharePoint Online has real-time monitoring to detect when an HTTP request reads or writes data for more than one tenant.</span></span> <span data-ttu-id="649bb-169">要求 id *subscriptionid*は、アクセスされるリソースの*subscriptionid*に対して追跡されます。</span><span class="sxs-lookup"><span data-stu-id="649bb-169">The request identity *SubscriptionId* is tracked against the *SubscriptionId* of the accessed resource.</span></span> <span data-ttu-id="649bb-170">複数のテナントのリソースにアクセスする要求は、エンドユーザーによって発生することはありません。</span><span class="sxs-lookup"><span data-stu-id="649bb-170">Requests to access resources of more than one tenant should never happen by end users.</span></span> <span data-ttu-id="649bb-171">マルチテナント環境のサービス要求だけが例外です。</span><span class="sxs-lookup"><span data-stu-id="649bb-171">Service requests in a multi-tenant environment are the only exception.</span></span> <span data-ttu-id="649bb-172">たとえば、検索クローラーは、データベース全体に対するコンテンツの変更を一度に1つずつ取得します。</span><span class="sxs-lookup"><span data-stu-id="649bb-172">For example, the search crawler pulls content changes for an entire database all at once.</span></span> <span data-ttu-id="649bb-173">通常、1つのサービス要求で複数のテナントのサイトに対してクエリを実行する必要があります。これは、効率性上の理由によります。</span><span class="sxs-lookup"><span data-stu-id="649bb-173">This usually involves querying sites of more than one tenant in a single service request, which is done for efficiency reasons.</span></span>
