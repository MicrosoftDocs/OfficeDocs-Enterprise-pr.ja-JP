---
title: Office 365 のパフォーマンス トラブルシューティング計画
ms.author: kvice
author: kelleyvice-msft
manager: laurawi
ms.date: 5/10/2019
audience: Admin
ms.topic: conceptual
ms.service: o365-administration
localization_priority: Normal
f1.keywords:
- CSH
ms.custom:
- Adm_O365
- seo-marvel-apr2020
search.appverid:
- MET150
- MOE150
- BCS160
ms.assetid: e241e5d9-b1d8-4f1d-a5c8-4106b7325f8c
ms.collection:
- M365-security-compliance
- Ent_O365
description: この記事は、Office 365 のパフォーマンスの問題をトラブルシューティングしたり、最も一般的な問題のいくつかを修正したりするのに役立ちます。
ms.openlocfilehash: cfb99aa9184f61a924a9dbf46d7761482b828be0
ms.sourcegitcommit: 8634215e257ba2d49832a8f5947700fd00f18ece
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/10/2020
ms.locfileid: "46606263"
---
# <a name="performance-troubleshooting-plan-for-office-365"></a><span data-ttu-id="16752-103">Office 365 のパフォーマンス トラブルシューティング計画</span><span class="sxs-lookup"><span data-stu-id="16752-103">Performance troubleshooting plan for Office 365</span></span>

<span data-ttu-id="16752-104">SharePoint Online、OneDrive for Business、Exchange Online、または Skype for Business Online とクライアントコンピューターの間で、遅延、ハング、および低速のパフォーマンスを識別して修正するための手順を把握しておく必要がありますか。</span><span class="sxs-lookup"><span data-stu-id="16752-104">Do you need to know the steps to take to identify and fix lags, hangs, and slow performance between SharePoint Online, OneDrive for Business, Exchange Online, or Skype for Business Online, and your client computer?</span></span> <span data-ttu-id="16752-105">サポートに連絡する前に、この記事は Office 365 のパフォーマンスの問題をトラブルシューティングしたり、最も一般的な問題のいくつかを修正したりするのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="16752-105">Before you call support, this article can help you troubleshoot Office 365 performance issues and even fix some of the most common issues.</span></span>
  
<span data-ttu-id="16752-106">この記事は実際には、パフォーマンスの問題に関する貴重なデータを収集するために使用できるサンプルのアクションプランです。</span><span class="sxs-lookup"><span data-stu-id="16752-106">This article is actually a sample action plan that you can use to capture valuable data about your performance issue as it's happening.</span></span> <span data-ttu-id="16752-107">この記事では、いくつかの主要な問題についても説明します。</span><span class="sxs-lookup"><span data-stu-id="16752-107">Some top issues are also included in this article.</span></span>

<span data-ttu-id="16752-108">ネットワークのパフォーマンスを初めて使用する場合に、クライアントコンピューターと Office 365 の間のパフォーマンスを監視するための長期的な計画を作成する場合は、「 [Office 365 のパフォーマンスチューニングとトラブルシューティング-管理および IT 担当者](performance-tuning-using-baselines-and-history.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="16752-108">If you're new to network performance and want to make a long term plan to monitor performance between your client machines and Office 365, take a look at [Office 365 performance tuning and troubleshooting - Admin and IT Pro](performance-tuning-using-baselines-and-history.md).</span></span>
  
## <a name="sample-performance-troubleshooting-action-plan"></a><span data-ttu-id="16752-109">サンプルのパフォーマンストラブルシューティングアクションプラン</span><span class="sxs-lookup"><span data-stu-id="16752-109">Sample performance troubleshooting action plan</span></span>

<span data-ttu-id="16752-110">このアクションプランには2つの部分が含まれています。準備フェーズとログフェーズ。</span><span class="sxs-lookup"><span data-stu-id="16752-110">This action plan contains two parts; a preparation phase, and a logging phase.</span></span> <span data-ttu-id="16752-111">現時点でパフォーマンス上の問題が発生していて、データ収集を行う必要がある場合は、すぐにこのプランの使用を開始することができます。</span><span class="sxs-lookup"><span data-stu-id="16752-111">If you have a performance problem right now, and you need to do data collection, you can start using this plan right away.</span></span>
  
### <a name="prepare-the-client-computer"></a><span data-ttu-id="16752-112">クライアントコンピューターを準備する</span><span class="sxs-lookup"><span data-stu-id="16752-112">Prepare the client computer</span></span>
  
- <span data-ttu-id="16752-113">パフォーマンスの問題を再現できるクライアントコンピューターを見つけます。</span><span class="sxs-lookup"><span data-stu-id="16752-113">Find a client computer that can reproduce the performance problem.</span></span> <span data-ttu-id="16752-114">このコンピューターは、トラブルシューティングの際に使用されます。</span><span class="sxs-lookup"><span data-stu-id="16752-114">This computer will be used during the course of troubleshooting.</span></span>
- <span data-ttu-id="16752-115">パフォーマンスの問題が発生する原因となる手順を記録して、テストするときに備えて準備します。</span><span class="sxs-lookup"><span data-stu-id="16752-115">Write down the steps that cause the performance problem to happen so you're ready when it comes time to test.</span></span>
- <span data-ttu-id="16752-116">情報を収集および記録するためのツールをインストールします。</span><span class="sxs-lookup"><span data-stu-id="16752-116">Install tools for gathering and recording information:</span></span>
  - <span data-ttu-id="16752-117">[Netmon 3.4](https://www.microsoft.com/download/details.aspx?id=4865)をインストールします (または、同等のネットワークトレースツールを使用します)。</span><span class="sxs-lookup"><span data-stu-id="16752-117">Install [Netmon 3.4](https://www.microsoft.com/download/details.aspx?id=4865) (or use an equivalent network tracing tool).</span></span>
  - <span data-ttu-id="16752-118">[Httpwatch](https://www.httpwatch.com/download/)の無料の基本エディションをインストールします (または、同等のネットワークトレースツールを使用します)。</span><span class="sxs-lookup"><span data-stu-id="16752-118">Install the free Basic Edition of [HTTPWatch](https://www.httpwatch.com/download/) (or use an equivalent network Tracing tool).</span></span>
  - <span data-ttu-id="16752-119">テスト中に実行する手順の記録を保持するために、画面記録機能を使用するか、Windows Vista 以降に付属する手順記録ツール (PSR.exe) を実行します。</span><span class="sxs-lookup"><span data-stu-id="16752-119">Use a screen recorder or run the Steps Recorder (PSR.exe) that comes with Windows Vista and later, in order to keep a record of the steps you take during testing.</span></span>

### <a name="log-the-performance-issue"></a><span data-ttu-id="16752-120">パフォーマンスの問題をログに記録する</span><span class="sxs-lookup"><span data-stu-id="16752-120">Log the performance issue</span></span>
  
- <span data-ttu-id="16752-121">不要なインターネットブラウザーをすべて閉じます。</span><span class="sxs-lookup"><span data-stu-id="16752-121">Close all extraneous Internet browsers.</span></span>
- <span data-ttu-id="16752-122">手順レコーダーまたは別のスクリーンレコーダーを開始します。</span><span class="sxs-lookup"><span data-stu-id="16752-122">Start the Steps Recorder, or another screen recorder.</span></span>
- <span data-ttu-id="16752-123">Netmon キャプチャを開始します (またはネットワークトレースツール)。</span><span class="sxs-lookup"><span data-stu-id="16752-123">Start your Netmon capture (or network tracing tool).</span></span>
- <span data-ttu-id="16752-124">「Ipconfig/flushdns」と入力して、コマンドラインからクライアントコンピューター上の DNS キャッシュをクリアします。</span><span class="sxs-lookup"><span data-stu-id="16752-124">Clear your DNS cache on the client computer from the command line by typing ipconfig /flushdns.</span></span>
- <span data-ttu-id="16752-125">新しいブラウザーセッションを開始し、HTTPWatch を有効にします。</span><span class="sxs-lookup"><span data-stu-id="16752-125">Start a new browser session and turn on HTTPWatch.</span></span>
- <span data-ttu-id="16752-126">オプション: Exchange Online をテストする場合は、Office 365 管理コンソールから Exchange クライアントパフォーマンスアナライザーツールを実行します。</span><span class="sxs-lookup"><span data-stu-id="16752-126">Optional: If you are testing Exchange Online, run the Exchange Client Performance Analyzer tool from the Office 365 admin console.</span></span>
- <span data-ttu-id="16752-127">パフォーマンスの問題を引き起こす正確な手順を再現します。</span><span class="sxs-lookup"><span data-stu-id="16752-127">Reproduce the exact steps that cause the performance issue.</span></span>
- <span data-ttu-id="16752-128">Netmon またはその他のツールのトレースを停止します。</span><span class="sxs-lookup"><span data-stu-id="16752-128">Stop your Netmon or other tool's trace.</span></span>
- <span data-ttu-id="16752-129">コマンドラインで、次のコマンドを入力し、ENTER キーを押して、Office 365 サブスクリプションへのトレースルートを実行します。</span><span class="sxs-lookup"><span data-stu-id="16752-129">At the command line, run a trace route to your Office 365 subscription by typing the following command and then pressing ENTER:</span></span>

  ``` cmd
  tracert <subscriptionname>.onmicrosoft.com
  ```

- <span data-ttu-id="16752-130">手順記録ツールを停止し、ビデオを保存します。</span><span class="sxs-lookup"><span data-stu-id="16752-130">Stop the Steps Recorder and save the video.</span></span> <span data-ttu-id="16752-131">キャプチャの日付と時刻を必ず指定してください。また、パフォーマンスが良好か悪いかを確認してください。</span><span class="sxs-lookup"><span data-stu-id="16752-131">Be sure to include the date and time of the capture and whether it demonstrates good or bad performance.</span></span>
- <span data-ttu-id="16752-132">トレースファイルを保存します。</span><span class="sxs-lookup"><span data-stu-id="16752-132">Save the trace files.</span></span> <span data-ttu-id="16752-133">この場合も、キャプチャの日付と時刻を必ず指定してください。また、パフォーマンスが良好であるか悪いかを示します。</span><span class="sxs-lookup"><span data-stu-id="16752-133">Again, be sure to include the date and time of the capture and whether it demonstrates good or bad performance.</span></span>

<span data-ttu-id="16752-134">この記事に記載されているツールの実行に精通していない場合は、これらの手順を次に提供するため、心配しないでください。</span><span class="sxs-lookup"><span data-stu-id="16752-134">If you're not familiar with running the tools mentioned in this article, don't worry because we provide those steps next.</span></span> <span data-ttu-id="16752-135">この種のネットワークキャプチャを実行することに慣れている場合は、[ベースラインを収集する方法](performance-tuning-using-baselines-and-history.md#how-to-collect-baselines)(フィルター処理とログの読み取りについて説明します) に進むことができます。</span><span class="sxs-lookup"><span data-stu-id="16752-135">If you're accustomed to doing this kind of network capturing, you can skip to [How to collect baselines](performance-tuning-using-baselines-and-history.md#how-to-collect-baselines), which describes filtering and reading the logs.</span></span>
  
### <a name="flush-the-dns-cache-first"></a><span data-ttu-id="16752-136">DNS キャッシュを最初にフラッシュする</span><span class="sxs-lookup"><span data-stu-id="16752-136">Flush the DNS Cache first</span></span>

<span data-ttu-id="16752-137">それはなぜでしょうか。</span><span class="sxs-lookup"><span data-stu-id="16752-137">Why?</span></span> <span data-ttu-id="16752-138">DNS キャッシュをフラッシュすることによって、クリーンな状態でテストを開始しています。</span><span class="sxs-lookup"><span data-stu-id="16752-138">By flushing out the DNS cache you're starting your tests with a clean slate.</span></span> <span data-ttu-id="16752-139">キャッシュをクリアすることで、DNS リゾルバーの内容が最新のエントリにリセットされます。</span><span class="sxs-lookup"><span data-stu-id="16752-139">By clearing the cache, you're resetting the DNS resolver contents to the most up-to-date entries.</span></span> <span data-ttu-id="16752-140">フラッシュは HOSTs ファイルエントリを削除しないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="16752-140">Remember that a flush does not remove HOSTs file entries.</span></span> <span data-ttu-id="16752-141">ホストファイルエントリを頻繁に使用する場合は、それらのエントリを別のディレクトリ内のファイルにコピーして、ホストファイルを空にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="16752-141">If you use HOST file entries extensively, you should copy those entries out to a file in another directory and then empty the HOST file.</span></span>
  
#### <a name="flush-your-dns-resolver-cache"></a><span data-ttu-id="16752-142">DNS リゾルバーキャッシュをフラッシュする</span><span class="sxs-lookup"><span data-stu-id="16752-142">Flush your DNS resolver cache</span></span>
  
1. <span data-ttu-id="16752-143">コマンドプロンプトを開きます ( **Start** \> **Run** \> **cmd**または**Windows key** cmd のどちらかを開始 \> **cmd**します)。</span><span class="sxs-lookup"><span data-stu-id="16752-143">Open the command prompt, (either **Start** \> **Run** \> **cmd** or **Windows key** \> **cmd**).</span></span>
2. <span data-ttu-id="16752-144">次のコマンドを入力し、Enter キーを押します。</span><span class="sxs-lookup"><span data-stu-id="16752-144">Type the following command and press ENTER:</span></span>

    ``` cmd
    ipconfig /flushdns
    ```

## <a name="netmon"></a><span data-ttu-id="16752-145">Netmon</span><span class="sxs-lookup"><span data-stu-id="16752-145">Netmon</span></span>

<span data-ttu-id="16752-146">Microsoft のネットワーク監視ツール ([Netmon](https://www.microsoft.com/download/details.aspx?id=4865)) は、ネットワーク上のコンピューター間を通過するパケット (トラフィック) を分析します。</span><span class="sxs-lookup"><span data-stu-id="16752-146">Microsoft's Network Monitoring tool ([Netmon](https://www.microsoft.com/download/details.aspx?id=4865)) analyzes packets, that is traffic, that passes between computers on networks.</span></span> <span data-ttu-id="16752-147">Netmon を使用して Office 365 とのトラフィックをトレースすることによって、パケットヘッダーのキャプチャ、表示、および読み取り、介在するデバイスの特定、ネットワークハードウェアでの重要な設定の確認、ドロップされたパケットの検索、企業ネットワークおよび Office 365 上のコンピューター間のトラフィックのフローに従うことができます。</span><span class="sxs-lookup"><span data-stu-id="16752-147">By using Netmon to trace traffic with Office 365 you can capture, view, and read packet headers, identify intervening devices, check important settings on network hardware, look for dropped packets, and follow the flow of traffic between computers on your corporate network and Office 365.</span></span> <span data-ttu-id="16752-148">トラフィックの実際の本文は暗号化されるため、つまり、SSL/TLS を介してポート443で転送されるため、送信中のファイルを読み取ることはできません。</span><span class="sxs-lookup"><span data-stu-id="16752-148">Because the actual body of the traffic is encrypted, that is, it(travels on port 443 via SSL/TLS, you can't read the files being sent.</span></span> <span data-ttu-id="16752-149">代わりに、パケットが取得するパスのフィルター処理されていないトレースを取得して、問題の動作を追跡するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="16752-149">Instead, you get an unfiltered trace of the path that the packet takes which can help you track down the problem behavior.</span></span>
  
<span data-ttu-id="16752-150">現時点では、フィルターを適用しないようにしてください。</span><span class="sxs-lookup"><span data-stu-id="16752-150">Be sure you don't apply a filter at this time.</span></span> <span data-ttu-id="16752-151">代わりに、手順を実行し、トレースを停止して保存を停止する前に問題をデモンストレーションします。</span><span class="sxs-lookup"><span data-stu-id="16752-151">Instead, run through the steps and demonstrate the problem before stopping the trace and saving.</span></span>
  
<span data-ttu-id="16752-152">Netmon 3.4 をインストールした後、ツールを開き、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="16752-152">After you install Netmon 3.4, open the tool and take these steps:</span></span>
  
### <a name="take-a-netmon-trace-and-reproduce-the-issue"></a><span data-ttu-id="16752-153">Netmon トレースを取得して問題を再現する</span><span class="sxs-lookup"><span data-stu-id="16752-153">Take a Netmon trace and reproduce the issue</span></span>
  
1. <span data-ttu-id="16752-154">Netmon 3.4 を起動します。</span><span class="sxs-lookup"><span data-stu-id="16752-154">Launch Netmon 3.4.</span></span>
<span data-ttu-id="16752-155">**スタート**ページには、[**最近のキャプチャ**]、 **[ネットワークの選択**]、および「 **Microsoft ネットワークモニターの使用を開始する3.4」の3つのウィンドウがあります。通知**。</span><span class="sxs-lookup"><span data-stu-id="16752-155">There are three panes on the **Start** page: **Recent Captures**, **Select Networks**, and the **Getting Started with Microsoft Network Monitor 3.4. Notice**.</span></span> <span data-ttu-id="16752-156">[ネットワークの選択] パネルには、キャプチャ可能な既定のネットワークの一覧も表示されます。</span><span class="sxs-lookup"><span data-stu-id="16752-156">The Select Networks panel will also give you a list of the default networks from which you can capture.</span></span> <span data-ttu-id="16752-157">ネットワークカードが選択されていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="16752-157">Be sure that network cards are selected here.</span></span>

2. <span data-ttu-id="16752-158">**スタート**ページの上部にある [**新しいキャプチャ**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-158">Click **New Capture** at the top of the **Start** page.</span></span> <span data-ttu-id="16752-159">これにより、[**キャプチャ 1**] という名前の [**スタート**ページ] タブの横に新しいタブが追加されます。</span><span class="sxs-lookup"><span data-stu-id="16752-159">This adds a new tab beside the **Start** page tab called **Capture 1**.</span></span>
<span data-ttu-id="16752-160">![新しいキャプチャ、開始、および停止ボタンが強調表示された Netmon のユーザーインターフェイス。](media/d4527d84-62ec-4301-82d5-e0166ff71f20.PNG)</span><span class="sxs-lookup"><span data-stu-id="16752-160">![Netmon's user interface with the New Capture, Start, and Stop buttons highlighted.](media/d4527d84-62ec-4301-82d5-e0166ff71f20.PNG)</span></span>

3. <span data-ttu-id="16752-161">簡単なキャプチャを行うには、ツールバーの [**スタート**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-161">To take a simple capture, click **Start** on the toolbar.</span></span>

4. <span data-ttu-id="16752-162">パフォーマンスの問題を示す手順を再現します。</span><span class="sxs-lookup"><span data-stu-id="16752-162">Reproduce the steps that present a performance issue.</span></span>

5. <span data-ttu-id="16752-163">[ **Stop** \> **ファイル** \> **名を付けて保存] を**クリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-163">Click **Stop** \> **File** \> **Save As**.</span></span> <span data-ttu-id="16752-164">タイムゾーンに日付と時刻を指定し、不良または良好なパフォーマンスを示しているかどうかを言及してください。</span><span class="sxs-lookup"><span data-stu-id="16752-164">Remember to give the date and time with the time zone and to mention if it demonstrates bad or good performance.</span></span>

## <a name="httpwatch"></a><span data-ttu-id="16752-165">HTTPWatch</span><span class="sxs-lookup"><span data-stu-id="16752-165">HTTPWatch</span></span>

<span data-ttu-id="16752-166">[Httpwatch](https://www.httpwatch.com/download/)は課金され、無料版が提供されます。</span><span class="sxs-lookup"><span data-stu-id="16752-166">[HTTPWatch](https://www.httpwatch.com/download/) comes in charged, and a free edition.</span></span> <span data-ttu-id="16752-167">このテストに必要なすべての情報は、無料の Basic Edition に記載されています。</span><span class="sxs-lookup"><span data-stu-id="16752-167">The free Basic Edition covers everything you need for this test.</span></span> <span data-ttu-id="16752-168">HTTPWatch は、ブラウザーウィンドウから、ネットワークトラフィックとページの読み込み時間を監視します。</span><span class="sxs-lookup"><span data-stu-id="16752-168">HTTPWatch monitors network traffic and page load time right from your browser window.</span></span> <span data-ttu-id="16752-169">HTTPWatch は、パフォーマンスをグラフィカルに説明する Internet Explorer のプラグインです。</span><span class="sxs-lookup"><span data-stu-id="16752-169">HTTPWatch is a plug-in to Internet Explorer that graphically describes performance.</span></span> <span data-ttu-id="16752-170">この分析は、HTTPWatch Studio で保存および表示できます。</span><span class="sxs-lookup"><span data-stu-id="16752-170">The analysis can be saved and viewed in HTTPWatch Studio.</span></span>
  
> [!NOTE]
> <span data-ttu-id="16752-171">別のブラウザー (Firefox、Google Chrome など) を使用する場合、または Internet Explorer に HTTPWatch をインストールできない場合は、新しいブラウザーウィンドウを開いて、キーボードで F12 キーを押します。</span><span class="sxs-lookup"><span data-stu-id="16752-171">If you use another browser, such as Firefox, Google Chrome, or if you can't install HTTPWatch in Internet Explorer, open a new browser window and press F12 on your keyboard.</span></span> <span data-ttu-id="16752-172">ブラウザーの下部に開発者ツールポップアップが表示されます。</span><span class="sxs-lookup"><span data-stu-id="16752-172">You should see the Developer Tool pop-up at the bottom of your browser.</span></span> <span data-ttu-id="16752-173">Opera を使用している場合は、CTRL + SHIFT + I を押して Web インスペクターを表示し、[**ネットワーク**] タブをクリックして、以下の手順で示されているテストを完了します。</span><span class="sxs-lookup"><span data-stu-id="16752-173">If you use Opera, press CTRL+SHIFT+I for Web Inspector, then click the **Network** tab and complete the testing outlined below.</span></span> <span data-ttu-id="16752-174">情報は少し異なりますが、読み込み時間は引き続きミリ秒単位で表示されます。</span><span class="sxs-lookup"><span data-stu-id="16752-174">The information will be slightly different, but load times will still be displayed in milliseconds.</span></span> <span data-ttu-id="16752-175">> HTTPWatch は、SharePoint Online ページの読み込み時間に関する問題にも非常に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="16752-175">> HTTPWatch is also very useful for issues with SharePoint Online page load times.</span></span>
  
### <a name="run-httpwatch-and-reproduce-the-issue"></a><span data-ttu-id="16752-176">HTTPWatch を実行し、問題を再現する</span><span class="sxs-lookup"><span data-stu-id="16752-176">Run HTTPWatch and reproduce the issue</span></span>
  
<span data-ttu-id="16752-177">HTTPWatch はブラウザープラグインなので、このツールをブラウザーに公開することは、Internet Explorer のバージョンごとに多少異なります。</span><span class="sxs-lookup"><span data-stu-id="16752-177">HTTPWatch is a browser plug-in, so exposing the tool in the browser is slightly different for each version of Internet Explorer.</span></span> <span data-ttu-id="16752-178">通常は、Internet Explorer ブラウザーのコマンドバーにある HTTPWatch を見つけることができます。</span><span class="sxs-lookup"><span data-stu-id="16752-178">Typically, you can find HTTPWatch under the Commands bar in the Internet Explorer browser.</span></span> <span data-ttu-id="16752-179">ブラウザーウィンドウに httpwatch プラグインが表示されない場合は、[**ヘルプ**] または internet explorer の以降のバージョンで、ブラウザーのバージョンを確認してください \> **About**。歯車記号と**internet explorer につい**ては、「」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="16752-179">If you don't see the HTTPWatch plug-in in your browser window, check the version of your browser by clicking **Help** \> **About**, or in later versions of Internet Explorer, click the gear symbol and **About Internet Explorer**.</span></span> <span data-ttu-id="16752-180">**コマンド**バーを起動するには、Internet Explorer のメニューバーを右クリックし、[**コマンドバー**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-180">To launch the **Commands** bar, right-click the menu bar in Internet Explorer and click **Commands bar**.</span></span>

<span data-ttu-id="16752-181">以前は、HTTPWatch はコマンドとエクスプローラーの両方のバーに関連付けられています。インストールすると、(再起動後も) アイコンがすぐに表示されない場合、またはアイコン**のツールバー**が表示されます。</span><span class="sxs-lookup"><span data-stu-id="16752-181">In the past, HTTPWatch has been associated with both the Commands and the Explorer bars, so once you install, if you don't immediately see the icon (even after reboot) check **Tools**, and your toolbars for the icon.</span></span> <span data-ttu-id="16752-182">ツールバーをカスタマイズしたり、オプションを追加したりすることができることを覚えておいてください。</span><span class="sxs-lookup"><span data-stu-id="16752-182">Remember that toolbars can be customized and options can be added to them.</span></span>

![HTTPWatch アイコンが表示されている Internet Explorer の [コマンド] ツールバー。](media/198590b0-d7b1-4bff-a6ad-e4ec3a1e83df.png)
  
1. <span data-ttu-id="16752-184">Internet Explorer ブラウザーウィンドウで HTTPWatch を起動します。</span><span class="sxs-lookup"><span data-stu-id="16752-184">Launch HTTPWatch in an Internet Explorer browser window.</span></span> <span data-ttu-id="16752-185">ウィンドウの下部に、ブラウザーにドッキングされた状態で表示されます。</span><span class="sxs-lookup"><span data-stu-id="16752-185">It will appear docked to the browser at the bottom of that window.</span></span> <span data-ttu-id="16752-186">[**レコード**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-186">Click **Record**.</span></span>

2. <span data-ttu-id="16752-187">パフォーマンスの問題に関係する正確な手順を再現します。</span><span class="sxs-lookup"><span data-stu-id="16752-187">Reproduce the exact steps involved in the performance issue.</span></span> <span data-ttu-id="16752-188">HTTPWatch の [**停止**] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-188">Click the **Stop** button in HTTPWatch.</span></span>

3. <span data-ttu-id="16752-189">HTTPWatch を**保存**するか、**電子メールで送信**します。</span><span class="sxs-lookup"><span data-stu-id="16752-189">**Save** the HTTPWatch or **Send by Email**.</span></span> <span data-ttu-id="16752-190">ファイルには、日付と時刻の情報が含まれていることを確認してください。また、監視に、パフォーマンスが良好であるか悪いかのデモンストレーションが含まれているかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="16752-190">Remember to name the file so that it includes date and time information and an indication of whether your Watch contains a demonstration of good or bad performance.</span></span>

![Office 365 ホームページのページ読み込み用の [ネットワーク] タブを示す HTTPWatch。](media/021a2c64-d581-49fd-adf4-4c364f589d75.PNG)

<span data-ttu-id="16752-192">このスクリーンショットは、HTTPWatch の Professional バージョンからのものです。</span><span class="sxs-lookup"><span data-stu-id="16752-192">This screen shot is from the Professional version of HTTPWatch.</span></span> <span data-ttu-id="16752-193">コンピューターの基本バージョンで取得したトレースを Professional バージョンと共に開いて、そこに読み取ることができます。</span><span class="sxs-lookup"><span data-stu-id="16752-193">You can open traces taken in the Basic Version on a computer with a Professional version and read it there.</span></span> <span data-ttu-id="16752-194">このメソッドを使用して、トレースからその他の情報を入手できる場合があります。</span><span class="sxs-lookup"><span data-stu-id="16752-194">Extra information may be available from the trace through that method.</span></span>

## <a name="problem-steps-recorder"></a><span data-ttu-id="16752-195">問題ステップ記録ツール</span><span class="sxs-lookup"><span data-stu-id="16752-195">Problem Steps Recorder</span></span>

<span data-ttu-id="16752-196">手順記録ツールまたは PSR.exe を使用すると、発生した問題を記録できます。</span><span class="sxs-lookup"><span data-stu-id="16752-196">Steps Recorder, or PSR.exe, allows you to record issues as they are occurring.</span></span> <span data-ttu-id="16752-197">非常に便利なツールであり、実行が非常に簡単です。</span><span class="sxs-lookup"><span data-stu-id="16752-197">It's a very useful tool and very simple to run.</span></span>
  
### <a name="run-problem-steps-recorder-psrexe-to-record-your-work"></a><span data-ttu-id="16752-198">作業を記録するために問題ステップ記録ツール (PSR.exe) を実行する</span><span class="sxs-lookup"><span data-stu-id="16752-198">Run Problem Steps Recorder (PSR.exe) to record your work</span></span>
  
1. <span data-ttu-id="16752-199">[**開始** \> の**実行**の種類を使用する \> ] **PSR.exe** \> **OK**] をクリックするか、[ **Windows キー**の種類PSR.exeをクリックし、 \> **PSR.exe** \> enter キーを押します。</span><span class="sxs-lookup"><span data-stu-id="16752-199">Either use **Start** \> **Run** \> type **PSR.exe** \> **OK**, or, click the **Windows Key** \> type **PSR.exe** \> and then press ENTER.</span></span>

2. <span data-ttu-id="16752-200">[Small PSR.exe] ウィンドウが表示されたら、[**開始**] をクリックして、パフォーマンスの問題を再現する手順を再現します。</span><span class="sxs-lookup"><span data-stu-id="16752-200">When the small PSR.exe window appears, click **Start Record** and reproduce the steps that reproduce the performance issue.</span></span> <span data-ttu-id="16752-201">[**コメントの追加**] をクリックすると、必要に応じてコメントを追加できます。</span><span class="sxs-lookup"><span data-stu-id="16752-201">You can add comments as needed, by clicking **Add Comments**.</span></span>

3. <span data-ttu-id="16752-202">手順を完了したら、[**レコードの停止**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-202">Click **Stop Record** when you have completed the steps.</span></span> <span data-ttu-id="16752-203">パフォーマンスの問題がページレンダリングの場合は、ページがレンダリングされるまで待機してから、録音を停止します。</span><span class="sxs-lookup"><span data-stu-id="16752-203">If the performance issue is a page render, wait for the page to render before you stop the recording.</span></span>

4. <span data-ttu-id="16752-204">**[保存]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-204">Click **Save**.</span></span>

![手順記録ツールまたは PSR.exe のスクリーンショット。](media/8542b0aa-a3ff-4718-8dc4-43f5521c6c34.PNG)
  
<span data-ttu-id="16752-206">日付と時刻が記録されます。</span><span class="sxs-lookup"><span data-stu-id="16752-206">The date and time is recorded for you.</span></span> <span data-ttu-id="16752-207">これにより、PSR が Netmon トレースと HTTPWatch にリンクされ、精度のトラブルシューティングに役立てることができます。</span><span class="sxs-lookup"><span data-stu-id="16752-207">This links your PSR to your Netmon trace and HTTPWatch in time, and helps with precision troubleshooting.</span></span> <span data-ttu-id="16752-208">PSR レコードの日付と時刻には、例として、URL のログインと参照と、管理サイトの部分的なレンダリングの間に1分間経過したことを示すことができます。</span><span class="sxs-lookup"><span data-stu-id="16752-208">The date and time in the PSR record can show that a minute passed between the login and browsing of the URL and the partial render of the admin site, for example.</span></span>
  
## <a name="read-your-traces"></a><span data-ttu-id="16752-209">トレースの読み取り</span><span class="sxs-lookup"><span data-stu-id="16752-209">Read your traces</span></span>

<span data-ttu-id="16752-210">ネットワークとパフォーマンスのトラブルシューティングについて、他のユーザーが記事で知っておく必要のあるものをすべて教えることはできません。</span><span class="sxs-lookup"><span data-stu-id="16752-210">It isn't possible to teach everything about network and performance troubleshooting that someone would need to know via an article.</span></span> <span data-ttu-id="16752-211">パフォーマンスを良好なものにすると、ネットワークの動作や通常の動作に関する知識が得やすくなります。</span><span class="sxs-lookup"><span data-stu-id="16752-211">Getting good at performance takes experience, and knowledge of how your network works and usually performs.</span></span> <span data-ttu-id="16752-212">ただし、主要な問題の一覧を切り上げることができます。また、ツールを使用して、最も一般的な問題を回避する方法を簡単に確認できます。</span><span class="sxs-lookup"><span data-stu-id="16752-212">But it is possible to round up a list of top issues and show how tools can make it easier for you to eliminate the most common problems.</span></span>
  
<span data-ttu-id="16752-213">Office 365 サイトのネットワークトレースを読み取るスキルを習得する必要がある場合は、ページ読み込みのトレースを定期的に作成し、閲覧経験があるよりも教師の方が簡単です。</span><span class="sxs-lookup"><span data-stu-id="16752-213">If you want to pick up skills reading network traces for your Office 365 sites, there is no better teacher than creating traces of page loads regularly and gaining experience reading them.</span></span> <span data-ttu-id="16752-214">たとえば、チャンスがある場合は、Office 365 サービスを読み込んで、そのプロセスをトレースします。</span><span class="sxs-lookup"><span data-stu-id="16752-214">For example, when you have a chance, load an Office 365 service and trace the process.</span></span> <span data-ttu-id="16752-215">DNS トラフィックのトレースをフィルター処理するか、参照したサービスの名前をフレームデータで検索します。</span><span class="sxs-lookup"><span data-stu-id="16752-215">Filter the trace for DNS traffic, or search the FrameData for the name of the service you browsed.</span></span> <span data-ttu-id="16752-216">トレースをスキャンして、サービスの読み込み時に発生する手順を把握します。</span><span class="sxs-lookup"><span data-stu-id="16752-216">Scan the trace to get an idea of the steps that occur when the service loads.</span></span> <span data-ttu-id="16752-217">これは、通常のページ読み込みがどのように表示されるか、またトラブルシューティングの場合には特にパフォーマンスに関して、良好なトレースを比較することで多くのことを説明するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="16752-217">This will help you learn what normal page load should look like, and in the case of troubleshooting, particularly around performance, comparing good to bad traces can teach you a lot.</span></span>
  
<span data-ttu-id="16752-218">Netmon では、表示フィルターフィールドに Microsoft Intellisense が使用されます。</span><span class="sxs-lookup"><span data-stu-id="16752-218">Netmon uses Microsoft Intellisense in the Display filter field.</span></span> <span data-ttu-id="16752-219">Intellisense、またはインテリジェントコード補完は、期間内に入力したすべてのオプションがドロップダウン選択ボックスに表示されるようにするために使用されます。</span><span class="sxs-lookup"><span data-stu-id="16752-219">Intellisense, or intelligent code completion, is that trick where you type in a period and all available options are displayed in a drop-down selection box.</span></span> <span data-ttu-id="16752-220">たとえば、TCP ウィンドウスケーリングについて懸念している場合は、フィルター (など) をこの方法で見つけることができ `.protocol.tcp.window < 100` ます。</span><span class="sxs-lookup"><span data-stu-id="16752-220">If, for example, you are worried about TCP window scaling, you can find your way to a filter (such as  `.protocol.tcp.window < 100`) by this means.</span></span>
  
![[表示フィルター] フィールドが intellisense を使用していることを示す Netmon のスクリーンショット。](media/75a56c11-9a60-47ee-a100-aabdfb1ba10f.PNG)
  
<span data-ttu-id="16752-222">Netmon トレースには、トラフィックが大量にある場合があります。</span><span class="sxs-lookup"><span data-stu-id="16752-222">Netmon traces can have a lot of traffic in them.</span></span> <span data-ttu-id="16752-223">このような情報が読み取られない場合は、最初にトレースを開いたときに大きな負荷が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="16752-223">If you aren't experienced with reading them, it's likely you will be overwhelmed opening the trace the first time.</span></span> <span data-ttu-id="16752-224">最初に行うことは、トレースのバックグラウンドノイズからの信号とは別のものです。</span><span class="sxs-lookup"><span data-stu-id="16752-224">The first thing to do is separate the signal from the background noise in the trace.</span></span> <span data-ttu-id="16752-225">Office 365 に対するテストを行い、これが表示するトラフィックです。</span><span class="sxs-lookup"><span data-stu-id="16752-225">You tested against Office 365, and that's the traffic you want to see.</span></span> <span data-ttu-id="16752-226">トレース間を移動するために使用している場合は、この一覧は必要ありません。</span><span class="sxs-lookup"><span data-stu-id="16752-226">If you are used to navigating through traces, you may not need this list.</span></span>
  
<span data-ttu-id="16752-227">クライアントと Office 365 間のトラフィックは TLS 経由で転送されるため、トラフィックの本文は暗号化され、汎用の Netmon トレースでは読み取ることができなくなります。</span><span class="sxs-lookup"><span data-stu-id="16752-227">Traffic between your client and Office 365 travels via TLS, which means that the body of the traffic will be encrypted and not readable in a generic Netmon trace.</span></span> <span data-ttu-id="16752-228">パフォーマンス分析では、パケット内の情報の詳細を知る必要はありません。</span><span class="sxs-lookup"><span data-stu-id="16752-228">Your performance analysis doesn't need to know the specifics of the information in the packet.</span></span> <span data-ttu-id="16752-229">ただし、パケットヘッダーとそれに含まれる情報には、非常に興味があります。</span><span class="sxs-lookup"><span data-stu-id="16752-229">It is, however, very interested in packet headers and the information that they contain.</span></span>
  
### <a name="tips-to-get-a-good-trace"></a><span data-ttu-id="16752-230">適切なトレースを得るためのヒント</span><span class="sxs-lookup"><span data-stu-id="16752-230">Tips to get a good trace</span></span>
  
- <span data-ttu-id="16752-231">クライアントコンピューターの IPv4 または IPv6 アドレスの値を確認します。</span><span class="sxs-lookup"><span data-stu-id="16752-231">Know the value of the IPv4 or IPv6 address of your client computer.</span></span> <span data-ttu-id="16752-232">これをコマンドプロンプトから取得するには、「 **IPConfig** 」と入力し、enter キーを押します。</span><span class="sxs-lookup"><span data-stu-id="16752-232">You can get this from the command prompt by typing **IPConfig** and then pressing ENTER.</span></span> <span data-ttu-id="16752-233">このアドレスを知っていると、トレース内のトラフィックにクライアントコンピューターが直接含まれているかどうかをひとめで知ることができるようになります。</span><span class="sxs-lookup"><span data-stu-id="16752-233">Knowing this address will let you tell at a glance whether the traffic in the trace directly involves your client computer.</span></span> <span data-ttu-id="16752-234">既知のプロキシがある場合は、それに対して ping を行い、その IP アドレスも取得します。</span><span class="sxs-lookup"><span data-stu-id="16752-234">If there is a known proxy, ping it and get its IP address as well.</span></span>

- <span data-ttu-id="16752-235">DNS リゾルバーキャッシュをフラッシュし、可能な場合は、テストを実行しているブラウザー以外のすべてのブラウザーを閉じます。</span><span class="sxs-lookup"><span data-stu-id="16752-235">Flush your DNS resolver cache and, if possible, close all browsers except the one in which you are running your tests.</span></span> <span data-ttu-id="16752-236">たとえば、サポートがクライアントコンピューターのデスクトップを表示するためにブラウザーベースのツールを使用している場合は、この操作を行うことができない場合は、トレースにフィルターをかける準備をしてください。</span><span class="sxs-lookup"><span data-stu-id="16752-236">If you are not able to do this, for instance, if support is using some browser-based tool to see your client computer's desktop, be prepared to filter your trace.</span></span>

- <span data-ttu-id="16752-237">通話中のトレースで、使用している Office 365 サービスを見つけます。</span><span class="sxs-lookup"><span data-stu-id="16752-237">In a busy trace, locate the Office 365 service that you're using.</span></span> <span data-ttu-id="16752-238">以前にトラフィックが発生したことがないかめったにわからない場合、これは、パフォーマンスの問題を他のネットワークノイズから分離するための便利な手順です。</span><span class="sxs-lookup"><span data-stu-id="16752-238">If you've never or seldom seen your traffic before, this is a helpful step in separating the performance issue from other network noise.</span></span> <span data-ttu-id="16752-239">これを行うには、いくつかの方法があります。</span><span class="sxs-lookup"><span data-stu-id="16752-239">There are a few ways to do this.</span></span> <span data-ttu-id="16752-240">テストの直前に、 _ping_または_psping_を特定のサービスの URL (またはなど) に対して使用でき `ping outlook.office365.com` `psping -4 microsoft-my.sharepoint.com:443` ます。</span><span class="sxs-lookup"><span data-stu-id="16752-240">Directly before your test, you can use _ping_ or _PsPing_ against the URL of the specific service (`ping outlook.office365.com` or `psping -4 microsoft-my.sharepoint.com:443`, for example).</span></span> <span data-ttu-id="16752-241">また、Netmon トレースに ping や PsPing がある場合は、そのプロセス名を使用すると簡単に見つけることができます。</span><span class="sxs-lookup"><span data-stu-id="16752-241">You can also easily find that ping or PsPing in a Netmon trace (by its process name).</span></span> <span data-ttu-id="16752-242">これで、検索を開始する場所がわかります。</span><span class="sxs-lookup"><span data-stu-id="16752-242">That will give you a place to start looking.</span></span>

<span data-ttu-id="16752-243">問題が発生した時点で Netmon トレースのみを使用している場合は、この方法でもかまいません。</span><span class="sxs-lookup"><span data-stu-id="16752-243">If you're only using Netmon tracing at the time of the problem, that's okay too.</span></span> <span data-ttu-id="16752-244">自分の向きを自分で理解するには、またはのようなフィルターを使用し `ContainsBin(FrameData, ASCII, "office")` `ContainsBin(FrameData, ASCII, "outlook")` ます。</span><span class="sxs-lookup"><span data-stu-id="16752-244">To orient yourself, use a filter like `ContainsBin(FrameData, ASCII, "office")` or `ContainsBin(FrameData, ASCII, "outlook")`.</span></span> <span data-ttu-id="16752-245">フレーム番号は、トレースファイルから記録できます。</span><span class="sxs-lookup"><span data-stu-id="16752-245">You can record your frame number from the trace file.</span></span> <span data-ttu-id="16752-246">また、[_フレームの概要_] ウィンドウを右端までスクロールして、[会話 ID] 列を検索することもできます。</span><span class="sxs-lookup"><span data-stu-id="16752-246">You may also want to scroll the _Frame Summary_ pane all the way to the right and look for the Conversation ID column.</span></span> <span data-ttu-id="16752-247">この特定の会話の ID に対して指定された番号があります。これは、後で分離して記録して確認することもできます。</span><span class="sxs-lookup"><span data-stu-id="16752-247">There is a number indicated there for the ID of this specific conversation that you can also record and look at in isolation later.</span></span> <span data-ttu-id="16752-248">他のフィルターを適用する前に、必ずこのフィルターを削除してください。</span><span class="sxs-lookup"><span data-stu-id="16752-248">Remember to remove this filter before applying any other filtering.</span></span>

> [!TIP]
> <span data-ttu-id="16752-249">Netmon には、多くの便利な組み込みフィルターが用意されています。</span><span class="sxs-lookup"><span data-stu-id="16752-249">Netmon has a lot of helpful built-in filters.</span></span> <span data-ttu-id="16752-250">[フィルターの_表示_] ウィンドウの上部にある [**フィルターの読み込み**] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-250">Try the **Load Filter** button at the top of the _Display_ filter pane.</span></span>
  
![クライアントコンピューターのコマンドラインで PSPing を使用して、IP を検索します。](media/4c43ac67-e28e-4536-842d-7add7aa28847.PNG)
  
![フィルター TCP を使用して同じ PSPing コマンドを表示しているクライアントからの Netmon トレース。フラグ Syn = = 1。](media/0ae7ef7d-e003-4d01-a006-dc49bd1fcef2.PNG)
  
<span data-ttu-id="16752-253">トラフィックについて理解を深めると、必要な情報を見つけてください。</span><span class="sxs-lookup"><span data-stu-id="16752-253">Get familiar with your traffic, and learn to locate the information you need.</span></span> <span data-ttu-id="16752-254">たとえば、使用している Office 365 サービス ("Outlook" など) への最初の参照が、トレースに含まれているパケットにあるかどうかを確認する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="16752-254">For example, learn to determine which packet in the trace has the first reference to the Office 365 service you're using (like "Outlook").</span></span>

<span data-ttu-id="16752-255">Office 365 の Outlook Online の使用例として、トラフィックは次のように開始されます。</span><span class="sxs-lookup"><span data-stu-id="16752-255">Taking Office 365 Outlook Online as an example, the traffic begins something like this:</span></span>
  
- <span data-ttu-id="16752-256">一致する QueryIDs を持つ outlook.office365.com の DNS 標準クエリと DNS 応答。</span><span class="sxs-lookup"><span data-stu-id="16752-256">DNS Standard Query and DNS Response for outlook.office365.com with matching QueryIDs.</span></span> <span data-ttu-id="16752-257">このターンアラウンドの時間オフセットと、世界中の Office 365 グローバル DNS が名前解決の要求を送信する場所について注意することが重要です。</span><span class="sxs-lookup"><span data-stu-id="16752-257">It's important to note the time offset for this turn-around, as well as where in the world the Office 365 Global DNS sends the request for name resolution.</span></span> <span data-ttu-id="16752-258">世界中に半分ではなく、可能な限りローカルにするのが理想的です。</span><span class="sxs-lookup"><span data-stu-id="16752-258">Ideally, as locally as possible, rather than halfway across the world.</span></span>

- <span data-ttu-id="16752-259">状態レポートが完全に移動された HTTP GET 要求 (301)</span><span class="sxs-lookup"><span data-stu-id="16752-259">A HTTP GET Request whose status report Moved Permanently (301)</span></span>

- <span data-ttu-id="16752-260">X-RWS-VERSION トラフィックを含む、X-RWS-VERSION Connect 要求と接続応答。</span><span class="sxs-lookup"><span data-stu-id="16752-260">RWS Traffic including RWS Connect requests and Connect replies.</span></span> <span data-ttu-id="16752-261">(これは、リモート Winsock を使用して接続を確立します。)</span><span class="sxs-lookup"><span data-stu-id="16752-261">(This is Remote Winsock making a connection for you.)</span></span>

- <span data-ttu-id="16752-262">TCP SYN および TCP SYN/ACK の会話。</span><span class="sxs-lookup"><span data-stu-id="16752-262">A TCP SYN and TCP SYN/ACK conversation.</span></span> <span data-ttu-id="16752-263">この会話の設定の多くは、パフォーマンスに影響します。</span><span class="sxs-lookup"><span data-stu-id="16752-263">A lot of the settings in this conversation impact your performance.</span></span>

- <span data-ttu-id="16752-264">次に、tls ハンドシェイクと TLS 証明書の会話が行われる一連の TLS: TLS トラフィック。</span><span class="sxs-lookup"><span data-stu-id="16752-264">Then a series of TLS:TLS traffic which is where the TLS handshake and TLS certificate conversations take place.</span></span> <span data-ttu-id="16752-265">(データが SSL/TLS 経由で暗号化されていることを思い出してください)。</span><span class="sxs-lookup"><span data-stu-id="16752-265">(Remember the data is encrypted via SSL/TLS.)</span></span>

<span data-ttu-id="16752-266">トラフィックのすべての部分は重要であり、接続されていますが、トレースの小さな部分にはパフォーマンスのトラブルシューティングの観点から特に重要な情報が含まれています。そのため、これらの領域を中心に説明します。</span><span class="sxs-lookup"><span data-stu-id="16752-266">All parts of the traffic are important and connected, but small portions of the trace contain information particularly important in terms of performance troubleshooting, so we'll focus on those areas.</span></span> <span data-ttu-id="16752-267">また、Microsoft では、一般的な問題の上位10個のリストをコンパイルするために十分な数の Office 365 パフォーマンストラブルシューティングを行っているので、これらの問題について説明し、次にそれらのツールを使用する方法について取り上げます。</span><span class="sxs-lookup"><span data-stu-id="16752-267">Also, since we've done enough Office 365 performance troubleshooting at Microsoft to compile a Top Ten list of common problems, we'll focus on those issues and how to use the tools we have to root them out next.</span></span>
  
<span data-ttu-id="16752-268">すべての準備が整っていない場合は、下の表でいくつかのツールを利用できます。</span><span class="sxs-lookup"><span data-stu-id="16752-268">If you haven't installed them all ready, the matrix below makes use of several tools.</span></span> <span data-ttu-id="16752-269">可能です。</span><span class="sxs-lookup"><span data-stu-id="16752-269">Where possible.</span></span> <span data-ttu-id="16752-270">リンクはインストールポイントに提供されます。</span><span class="sxs-lookup"><span data-stu-id="16752-270">Links are provided to the installation points.</span></span> <span data-ttu-id="16752-271">この一覧には、 [Netmon](https://www.microsoft.com/download/details.aspx?id=4865)や[Wireshark](https://www.wireshark.org/)などの一般的なネットワークトレースツールが含まれていますが、使い慣れたトレースツールを使用します。また、ネットワークトラフィックのフィルター処理に慣れています。</span><span class="sxs-lookup"><span data-stu-id="16752-271">The list includes common network tracing tools like [Netmon](https://www.microsoft.com/download/details.aspx?id=4865) and [Wireshark](https://www.wireshark.org/), but use any tracing tool you are comfortable with, and in which you're accustomed to filtering network traffic.</span></span> <span data-ttu-id="16752-272">テストを行うときは、次の点に注意してください。</span><span class="sxs-lookup"><span data-stu-id="16752-272">When you're testing, remember:</span></span>
  
- <span data-ttu-id="16752-273">*ブラウザーを閉じて、実行しているブラウザーが1つだけで*あることをテストします。これにより、キャプチャしたトラフィック全体が減ります。</span><span class="sxs-lookup"><span data-stu-id="16752-273">*Close your browsers, and test with only one browser running*  - This will reduce the overall traffic you capture.</span></span> <span data-ttu-id="16752-274">これにより、使用率の低いトレースが作成されます。</span><span class="sxs-lookup"><span data-stu-id="16752-274">It makes for a less busy trace.</span></span>
- <span data-ttu-id="16752-275">*クライアントコンピューターで DNS リゾルバーキャッシュをフラッシュ*する-これにより、クリーンなトレースのためにキャプチャの取得を開始したときに、クリーンな状態が得られます。</span><span class="sxs-lookup"><span data-stu-id="16752-275">*Flush your DNS resolver cache on the client computer*  - This will give you a clean slate when you start to take your capture, for a cleaner trace.</span></span>

## <a name="common-issues"></a><span data-ttu-id="16752-276">一般的な問題</span><span class="sxs-lookup"><span data-stu-id="16752-276">Common issues</span></span>

<span data-ttu-id="16752-277">よくある問題と、ネットワークトレースでそれらを見つける方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="16752-277">Some common issues you may face and how to find them in your Network trace.</span></span>

### <a name="tcp-windows-scaling"></a><span data-ttu-id="16752-278">TCP ウィンドウスケーリング</span><span class="sxs-lookup"><span data-stu-id="16752-278">TCP Windows Scaling</span></span>

<span data-ttu-id="16752-279">SYN SYN/ACK にあります。</span><span class="sxs-lookup"><span data-stu-id="16752-279">Found in the SYN - SYN/ACK.</span></span> <span data-ttu-id="16752-280">レガシまたはエージングハードウェアは、TCP windows スケーリングを利用できない場合があります。</span><span class="sxs-lookup"><span data-stu-id="16752-280">Legacy or aging hardware may not take advantage of TCP windows scaling.</span></span>  <span data-ttu-id="16752-281">適切な TCP windows スケーリング設定を使用しない場合、TCP ヘッダー内の既定の16ビットバッファーはミリ秒単位で入力されます。</span><span class="sxs-lookup"><span data-stu-id="16752-281">Without proper TCP windows scaling settings, the default 16-bit buffer in TCP headers fills in milliseconds.</span></span>  <span data-ttu-id="16752-282">元のデータが受信され、遅延が発生するまで、クライアントが受信確認を受信するまで、トラフィックは送信を続行できません。</span><span class="sxs-lookup"><span data-stu-id="16752-282">Traffic cannot continue to send until the client receives an acknowledgment that the original data has been received, causing delays.</span></span>

#### <a name="tools"></a><span data-ttu-id="16752-283">ツール</span><span class="sxs-lookup"><span data-stu-id="16752-283">Tools</span></span>

- <span data-ttu-id="16752-284">Netmon</span><span class="sxs-lookup"><span data-stu-id="16752-284">Netmon</span></span>
- <span data-ttu-id="16752-285">Wireshark</span><span class="sxs-lookup"><span data-stu-id="16752-285">Wireshark</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="16752-286">検索対象</span><span class="sxs-lookup"><span data-stu-id="16752-286">What to look for</span></span>

<span data-ttu-id="16752-287">ネットワークトレースで SYN SYN/ACK トラフィックを探します。</span><span class="sxs-lookup"><span data-stu-id="16752-287">Look for the SYN - SYN/ACK traffic in your network trace.</span></span>  <span data-ttu-id="16752-288">Netmon で、次のようなフィルターを使用 `tcp.flags.syn == 1` します。</span><span class="sxs-lookup"><span data-stu-id="16752-288">In Netmon, use a filter like  `tcp.flags.syn == 1`.</span></span> <span data-ttu-id="16752-289">このフィルターは Wireshark でも同じです。</span><span class="sxs-lookup"><span data-stu-id="16752-289">This filter is the same in Wireshark.</span></span>  

![Netmon または Wireshark で、両方のツールの Syn パケットにフィルターを適用します。 TCP。フラグ Syn = = 1。](media/4b9a12a1-c915-43c8-ac2f-a679d0435a29.PNG)

<span data-ttu-id="16752-291">SYN ごとに、関連する受信確認 (SYN/ACK) の宛先ポート (DstPort) に一致する送信元ポート (SrcPort) 番号があることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="16752-291">Notice that for every SYN there is a source port (SrcPort) number that is matched in the destination port (DstPort) of the related Acknowledgment (SYN/ACK).</span></span>

<span data-ttu-id="16752-292">ネットワーク接続によって使用される Windows のスケーリング値を確認するには、最初に SYN を展開してから、関連する SYN/ACK を展開します。</span><span class="sxs-lookup"><span data-stu-id="16752-292">To see the Windows Scaling value that is used by your network connection, expand first the SYN, and then the related SYN/ACK.</span></span>  

![時刻デルタを取得するために、トレースで SrcPort を DstPort に一致させる方法を示す図。](media/6a4ca573-0253-4fbd-93e8-92821ee1c351.png)  

### <a name="tcp-idle-time-settings"></a><span data-ttu-id="16752-294">TCP アイドル時間の設定</span><span class="sxs-lookup"><span data-stu-id="16752-294">TCP Idle Time Settings</span></span>

<span data-ttu-id="16752-295">従来は、ほとんどの境界ネットワークは一時的な接続に対して構成されており、アイドル状態の接続は一般に終了します。</span><span class="sxs-lookup"><span data-stu-id="16752-295">Historically, most perimeter networks are configured for transient connections, meaning idle connections are generally terminated.</span></span> <span data-ttu-id="16752-296">アイドル状態の TCP セッションは、プロキシとファイアウォールによって 100 ~ 300 秒を超えることで終了できます。</span><span class="sxs-lookup"><span data-stu-id="16752-296">Idle TCP sessions can be terminated by proxies and firewalls at greater than 100 to 300 seconds.</span></span> <span data-ttu-id="16752-297">これは、アイドル状態であるかどうかにかかわらず、長期間の接続を作成して使用するため、Outlook Online で問題が発生します。</span><span class="sxs-lookup"><span data-stu-id="16752-297">This is problematic for Outlook Online because it creates and uses long-term connections, whether they are idle or not.</span></span>  

<span data-ttu-id="16752-298">プロキシまたはファイアウォールデバイスによって接続が終了した場合、クライアントには通知されず、Outlook Online を使用しようとすると、クライアントコンピューターは、新しい接続を作成する前に接続を revive するために、何度も試行することを意味します。</span><span class="sxs-lookup"><span data-stu-id="16752-298">When connections are terminated by proxy or firewall devices, the client is not informed, and an attempt to use Outlook Online will mean a client computer will try, repeatedly, to revive the connection before making a new one.</span></span> <span data-ttu-id="16752-299">ページの読み込み時に、製品、プロンプト、またはパフォーマンスが低下することがあります。</span><span class="sxs-lookup"><span data-stu-id="16752-299">You may see hangs in the product, prompts, or slow performance on page load.</span></span>

#### <a name="tools"></a><span data-ttu-id="16752-300">ツール</span><span class="sxs-lookup"><span data-stu-id="16752-300">Tools</span></span>

- <span data-ttu-id="16752-301">Netmon</span><span class="sxs-lookup"><span data-stu-id="16752-301">Netmon</span></span>
- <span data-ttu-id="16752-302">Wireshark</span><span class="sxs-lookup"><span data-stu-id="16752-302">Wireshark</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="16752-303">検索対象</span><span class="sxs-lookup"><span data-stu-id="16752-303">What to look for</span></span>

<span data-ttu-id="16752-304">Netmon で、ラウンドトリップの [時間オフセット] フィールドを確認します。</span><span class="sxs-lookup"><span data-stu-id="16752-304">In Netmon, look at the Time Offset field for a round-trip.</span></span> <span data-ttu-id="16752-305">ラウンドトリップとは、クライアントが要求をサーバーに送信し、応答を返す時間のことです。</span><span class="sxs-lookup"><span data-stu-id="16752-305">A round-trip is the time between client sending a request to the server and receiving a response back.</span></span> <span data-ttu-id="16752-306">クライアントと出口の間でチェックを行います (例を参照)。</span><span class="sxs-lookup"><span data-stu-id="16752-306">Check between the Client and the egress point (ex.</span></span> <span data-ttu-id="16752-307">クライアント-- \> プロキシ)、またはクライアントから office 365 (クライアント-- \> office 365)。</span><span class="sxs-lookup"><span data-stu-id="16752-307">Client --\> Proxy), or the Client to Office 365 (Client --\> Office 365).</span></span> <span data-ttu-id="16752-308">このことは、多くの種類のパケットで確認できます。</span><span class="sxs-lookup"><span data-stu-id="16752-308">You can see this in many types of packets.</span></span>

<span data-ttu-id="16752-309">例として、Netmon のフィルターは、Wireshark のよう `.Protocol.IPv4.Address == 10.102.14.112 AND .Protocol.IPv4.Address == 10.201.114.12` になり `ip.addr == 10.102.14.112 &amp;&amp; ip.addr == 10.201.114.12` ます。</span><span class="sxs-lookup"><span data-stu-id="16752-309">As an example, the filter in Netmon may look like  `.Protocol.IPv4.Address == 10.102.14.112 AND .Protocol.IPv4.Address == 10.201.114.12`, or, in Wireshark,  `ip.addr == 10.102.14.112 &amp;&amp; ip.addr == 10.201.114.12`.</span></span>  

> [!TIP]
> <span data-ttu-id="16752-310">トレース内の IP アドレスが DNS サーバーに属しているかどうかはわかりませんか?</span><span class="sxs-lookup"><span data-stu-id="16752-310">Don't know if the IP address in your trace belongs to your DNS server?</span></span> <span data-ttu-id="16752-311">コマンドラインで検索してみてください。</span><span class="sxs-lookup"><span data-stu-id="16752-311">Try looking it up at the command line.</span></span> <span data-ttu-id="16752-312">[ **Start** \> **実行** \> を開始して**cmd**] をクリックするか、 **Windows キー**を押して \> **cmd**と入力します。</span><span class="sxs-lookup"><span data-stu-id="16752-312">Click **Start** \> **Run** \> and type **cmd**, or press **Windows Key** \> and type **cmd**.</span></span> <span data-ttu-id="16752-313">プロンプトで、と入力 `nslookup <the IP address from the network trace>` します。</span><span class="sxs-lookup"><span data-stu-id="16752-313">At the prompt, type  `nslookup <the IP address from the network trace>`.</span></span> <span data-ttu-id="16752-314">テストするには、自分のコンピューターの IP アドレスに対して nslookup を使用します。</span><span class="sxs-lookup"><span data-stu-id="16752-314">To test, use nslookup against your own computer's IP address.</span></span> <span data-ttu-id="16752-315">> Microsoft の IP 範囲の一覧を表示するには、「 [Office 365 の url と ip アドレスの範囲](https://technet.microsoft.com/library/hh373144.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="16752-315">> To see a list of Microsoft's IP ranges, see [Office 365 URLs and IP address ranges](https://technet.microsoft.com/library/hh373144.aspx).</span></span>

<span data-ttu-id="16752-316">問題が発生した場合は、長い時間のオフセットが表示されます (この例では Outlook Online)、特に TLS の場合はアプリケーションデータの流れを示す TLS パケット (たとえば、Netmon では、アプリケーションのデータパケットを経由して検索できます `.Protocol.TLS AND Description == "TLS:TLS Rec Layer-1 SSL Application Data"` )。</span><span class="sxs-lookup"><span data-stu-id="16752-316">If there is a problem, expect long Time Offsets to appear, in this case (Outlook Online), particularly in TLS:TLS packets that show the passage of Application Data (for example, in Netmon you can find application data packets via  `.Protocol.TLS AND Description == "TLS:TLS Rec Layer-1 SSL Application Data"`).</span></span> <span data-ttu-id="16752-317">セッション全体の時間が滑らかに表示されます。</span><span class="sxs-lookup"><span data-stu-id="16752-317">You should see a smooth progression in the time across the session.</span></span> <span data-ttu-id="16752-318">Outlook Online を更新するときに長い遅延が発生する場合は、リセットが大量に送信されることが原因として考えられます。</span><span class="sxs-lookup"><span data-stu-id="16752-318">If you see long delays when refreshing your Outlook Online, this could be caused by a high degree of resets being sent.</span></span>

### <a name="latencyround-trip-time"></a><span data-ttu-id="16752-319">待機時間/往復時間</span><span class="sxs-lookup"><span data-stu-id="16752-319">Latency/Round Trip Time</span></span>

<span data-ttu-id="16752-320">待機時間は、エージングデバイスのアップグレード、ネットワークへの多数のユーザーの追加、ネットワーク接続の他のタスクで消費される全体的な帯域幅の割合など、多くの要因に応じて頻繁に変化する測定です。</span><span class="sxs-lookup"><span data-stu-id="16752-320">Latency is a measure that can change a lot depending on many variables, such upgrading aging devices, adding a large number of users to a network, and the percentage of overall bandwidth consumed by other tasks on a network connection.</span></span>

<span data-ttu-id="16752-321">Office 365 用の帯域幅計算機は[、このネットワーク計画とパフォーマンスチューニングの office 365](network-planning-and-performance.md)ページから入手できます。</span><span class="sxs-lookup"><span data-stu-id="16752-321">There are bandwidth calculators for Office 365 available from this [Network planning and performance tuning for Office 365](network-planning-and-performance.md) page.</span></span>  

<span data-ttu-id="16752-322">接続の速度、または ISP 接続の帯域幅を測定する必要があるかどうか。</span><span class="sxs-lookup"><span data-stu-id="16752-322">Need to measure the speed of your connection, or your ISP connection's bandwidth?</span></span> <span data-ttu-id="16752-323">このサイト (またはその他のサイト): [Speedtest オフィシャルサイト](https://www.speedtest.net/)であるか、または、好きな検索エンジンで語句**速度テスト**のためにクエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="16752-323">Try this site (or sites like it): [Speedtest Official Site](https://www.speedtest.net/), or query your favorite search engine for the phrase **speed test**.</span></span>

#### <a name="tools"></a><span data-ttu-id="16752-324">ツール</span><span class="sxs-lookup"><span data-stu-id="16752-324">Tools</span></span>

- <span data-ttu-id="16752-325">コマンド</span><span class="sxs-lookup"><span data-stu-id="16752-325">Ping</span></span>
- <span data-ttu-id="16752-326">PsPing</span><span class="sxs-lookup"><span data-stu-id="16752-326">PsPing</span></span>
- <span data-ttu-id="16752-327">Netmon</span><span class="sxs-lookup"><span data-stu-id="16752-327">Netmon</span></span>
- <span data-ttu-id="16752-328">Wireshark</span><span class="sxs-lookup"><span data-stu-id="16752-328">Wireshark</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="16752-329">検索対象</span><span class="sxs-lookup"><span data-stu-id="16752-329">What to look for</span></span>

<span data-ttu-id="16752-330">トレースの待機時間を追跡するために、Office 365 でクライアントコンピューターの IP アドレスと DNS サーバーの IP アドレスを記録しておくと、メリットが得られます。</span><span class="sxs-lookup"><span data-stu-id="16752-330">To track latency in a trace, you will benefit from having recorded the client computer IP address and the IP address of the DNS server in Office 365.</span></span> <span data-ttu-id="16752-331">これは、トレースフィルター処理を容易にすることを目的としています。</span><span class="sxs-lookup"><span data-stu-id="16752-331">This is for the purpose of easier trace filtering.</span></span> <span data-ttu-id="16752-332">プロキシを介して接続する場合は、クライアントコンピューターの IP アドレス、プロキシ/出力 IP アドレス、および Office 365 DNS IP アドレスを使用して作業を容易にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="16752-332">If you connect through a proxy, you will need your client computer IP address, the proxy/egress IP address, and the Office 365 DNS IP address, to make the work easier.</span></span>  

<span data-ttu-id="16752-333">Outlook.office365.com に送信された ping 要求は、要求を受信しているデータセンターの名前を通知します。これは、ping が接続できない場合でも、商標を連続した ICMP パケットを送信する*ことが*できます。</span><span class="sxs-lookup"><span data-stu-id="16752-333">A ping request sent to outlook.office365.com will tell you the name of the datacenter receiving the request, even if ping  *may*  not be able to connect to send the trademark consecutive ICMP packets.</span></span> <span data-ttu-id="16752-334">PsPing (ダウンロード用の無料ツール) および特定のポート (443) を使用している場合は、送信されるパケットの平均ラウンドトリップ時間が得られます。</span><span class="sxs-lookup"><span data-stu-id="16752-334">If you use PsPing (a free tool for download), and specific the port (443) and perhaps to use IPv4 (-4) you will get an average round-trip-time for packets sent.</span></span> <span data-ttu-id="16752-335">これは、などの Office 365 サービスの他の Url に対して機能 `psping -4 yourSite.sharepoint.com:443` します。</span><span class="sxs-lookup"><span data-stu-id="16752-335">This will work this for other URLs in the Office 365 services, like `psping -4 yourSite.sharepoint.com:443`.</span></span> <span data-ttu-id="16752-336">実際には、いくつかの ping を指定して、平均に対してより大きなサンプルを取得することができ `psping -4 -n 20 yourSite-my.sharepoint.com:443` ます。</span><span class="sxs-lookup"><span data-stu-id="16752-336">In fact, you can specify a number of pings to get a larger sample for your average, try something like `psping -4 -n 20 yourSite-my.sharepoint.com:443`.</span></span>  

> [!NOTE]
> <span data-ttu-id="16752-337">PsPing は、ICMP パケットを送信しません。</span><span class="sxs-lookup"><span data-stu-id="16752-337">PsPing doesn't send ICMP packets.</span></span> <span data-ttu-id="16752-338">特定のポートを介して TCP パケットを使用して ping を実行することにより、知っていることがわかっているものをどれでも使用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="16752-338">It pings with TCP packets over a specific port, so you can use any one you know to be open.</span></span> <span data-ttu-id="16752-339">Office 365 で SSL/TLS を使用する場合は、ポート: 443 を PsPing に接続してみてください。</span><span class="sxs-lookup"><span data-stu-id="16752-339">In Office 365, which uses SSL/TLS, try attaching port :443 to your PsPing.</span></span>

![Outlook.office365.com を解決する ping と、443を使用した PSPing を示したスクリーンショットでは、同じことを行いますが、6.5 ミリ秒の平均 RTT も報告します。](media/c64339f2-2c96-45b8-b168-c2a060430266.PNG)

<span data-ttu-id="16752-341">ネットワークトレースの実行中に [実行時間の長い Office 365] ページを読み込んだ場合は、Netmon または Wireshark のトレースにフィルターを適用する必要があり `DNS` ます。</span><span class="sxs-lookup"><span data-stu-id="16752-341">If you loaded the slow performing Office 365 page while doing a network trace, you should filter a Netmon or Wireshark trace for `DNS`.</span></span> <span data-ttu-id="16752-342">これは、探している IPs の1つです。</span><span class="sxs-lookup"><span data-stu-id="16752-342">This is one of the IPs we're looking for.</span></span>  

<span data-ttu-id="16752-343">IP アドレスを取得するために Netmon をフィルター処理する手順は次のとおりです (DNS の待機時間を確認するため)。</span><span class="sxs-lookup"><span data-stu-id="16752-343">Here are the steps to take to filter your Netmon to get the IP address (and take a look at DNS Latency).</span></span> <span data-ttu-id="16752-344">この例では、outlook.office365.com を使用しますが、SharePoint Online テナントの URL (hithere.sharepoint.com など) を使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="16752-344">This example uses outlook.office365.com, but may also use the URL of a SharePoint Online tenant (hithere.sharepoint.com for example).</span></span>  

1. <span data-ttu-id="16752-345">URL に ping を実行し、結果に、 `ping outlook.office365.com` ping 要求が送信された DNS サーバーの名前と IP アドレスを記録します。</span><span class="sxs-lookup"><span data-stu-id="16752-345">Ping the URL `ping outlook.office365.com` and, in the results, record the name and IP address of the DNS server the ping request was sent to.</span></span>
2. <span data-ttu-id="16752-346">ネットワークトレースページを開くか、パフォーマンスの問題を解決するアクションを実行するか、ping に遅延が大きい場合は、ネットワークトレースします。</span><span class="sxs-lookup"><span data-stu-id="16752-346">Network trace opening the page, or doing the action that gives you the performance problem, or, if you see a high latency on the ping, itself, network trace it.</span></span>
3. <span data-ttu-id="16752-347">Netmon および DNS 用のフィルターでトレースを開きます (このフィルターは Wireshark でも動作しますが、大文字と小文字は区別され `-- dns` ます)。</span><span class="sxs-lookup"><span data-stu-id="16752-347">Open the trace in Netmon and filter for DNS (this filter also works in Wireshark, but is sensitive to case `-- dns`).</span></span> <span data-ttu-id="16752-348">Ping の DNS サーバーの名前がわかっているので、次のように、Netmon の speedily をさらにフィルター処理することもできます。このように `DNS AND ContainsBin(FrameData, ASCII, "namnorthwest")` 、Wireshark DNS と frame に "namnorthwest" が含まれています。</span><span class="sxs-lookup"><span data-stu-id="16752-348">Since you know the name of the DNS server from your ping you may also filter more speedily in Netmon like this: `DNS AND ContainsBin(FrameData, ASCII, "namnorthwest")`, which looks like this in Wireshark dns and frame contains "namnorthwest".</span></span><br/><span data-ttu-id="16752-349">応答パケットを開き、Netmon**フレームの詳細**ウィンドウで、[ **DNS** ] をクリックして詳細情報を展開します。</span><span class="sxs-lookup"><span data-stu-id="16752-349">Open the response packet and, in the Netmon **Frame Details** window, click **DNS** to expand for more information.</span></span> <span data-ttu-id="16752-350">DNS 情報には、Office 365 で要求が発生した DNS サーバーの IP アドレスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="16752-350">In the DNS information you'll find the IP address of the DNS server the request went to in Office 365.</span></span> <span data-ttu-id="16752-351">次の手順では、この IP アドレスが必要になります (PsPing ツール)。</span><span class="sxs-lookup"><span data-stu-id="16752-351">You'll need this IP address for the next step (the PsPing tool).</span></span> <span data-ttu-id="16752-352">フィルターを削除して、Netmon の dns 応答を右クリックし (**フレーム概要** \> **検索のスレッド** \> **DNS**)、dns クエリと応答を並べて表示します。</span><span class="sxs-lookup"><span data-stu-id="16752-352">Remove the filter, right-click on the DNS Response in Netmon (**Frame Summary** \> **Find Conversations** \> **DNS**) to see the DNS Query and Response side-by-side.</span></span>
4. <span data-ttu-id="16752-353">Netmon の場合は、DNS 要求と応答の間の [時間のオフセット] 列にも注意してください。</span><span class="sxs-lookup"><span data-stu-id="16752-353">In Netmon, also note the Time Offset  column between the DNS Request and Response.</span></span> <span data-ttu-id="16752-354">次の手順では、簡単にインストールおよび使用できる[psping](https://technet.microsoft.com/sysinternals/jj729731.aspx)ツールは、ICMP がファイアウォールでブロックされることが多いため、また、PsPing は短縮された遅延をミリ秒単位で追跡しているため、どちらも非常に便利です。</span><span class="sxs-lookup"><span data-stu-id="16752-354">In the next step, the easy-to-install and use [PsPing](https://technet.microsoft.com/sysinternals/jj729731.aspx) tool comes in very handy, both because ICMP is often blocked on Firewalls, and because PsPing elegantly tracks latency in milliseconds.</span></span> <span data-ttu-id="16752-355">PsPing は、アドレスとポートへの TCP 接続を完了します (この場合はオープンポート 443)。</span><span class="sxs-lookup"><span data-stu-id="16752-355">PsPing completes a TCP connection to an address and port (in our case open port 443).</span></span>
5. <span data-ttu-id="16752-356">PsPing をインストールします。</span><span class="sxs-lookup"><span data-stu-id="16752-356">Install PsPing.</span></span>
6. <span data-ttu-id="16752-357">コマンドプロンプト ( \> Run \> type cmd、または Windows キーの種類 cmd) を開き、psping を \> インストールしたディレクトリにディレクトリを変更して psping コマンドを実行します。</span><span class="sxs-lookup"><span data-stu-id="16752-357">Open a command prompt (Start \> Run \> type cmd, or Windows Key \> type cmd) and change directory to the directory where you installed PsPing to run the PsPing command.</span></span> <span data-ttu-id="16752-358">この例では、C のルートに ' Perf ' フォルダーを作成したことがわかります。この操作は、クイックアクセスに対して行うことができます。</span><span class="sxs-lookup"><span data-stu-id="16752-358">In my examples you can see I made a 'Perf' folder on the root of C. You can do the same for quick access.</span></span>
7. <span data-ttu-id="16752-359">以前の Netmon トレースから Office 365 DNS サーバーの IP アドレス (ポート番号など) に対して PsPing を行うには、このコマンドを入力し `psping -n 20 132.245.24.82:445` ます。</span><span class="sxs-lookup"><span data-stu-id="16752-359">Type the command so that you're making your PsPing against the IP address of the Office 365 DNS server from your earlier Netmon trace, including the port number, like `psping -n 20 132.245.24.82:445`.</span></span> <span data-ttu-id="16752-360">これにより、20個の ping をサンプリングして、PsPing が停止した場合の待機時間を平均することができます。</span><span class="sxs-lookup"><span data-stu-id="16752-360">This will give you a sampling of 20 pings and average the latency when PsPing stops.</span></span>

<span data-ttu-id="16752-361">プロキシサーバーを使用して Office 365 に移行する場合、手順は少し異なります。</span><span class="sxs-lookup"><span data-stu-id="16752-361">If you're going to Office 365 through a proxy server, the steps are a little different.</span></span> <span data-ttu-id="16752-362">プロキシサーバーに対して最初に PsPing を使用して、プロキシ/出力と復帰の平均待機時間をミリ秒単位で取得し、次に、プロキシで PsPing を実行するか、または直接インターネット接続を使用して、不足している値を取得します (一方は Office 365 および back)。</span><span class="sxs-lookup"><span data-stu-id="16752-362">You would first PsPing to your proxy server to get an average latency value in milliseconds to proxy/egress and back, and then either run PsPing on the proxy, or on a computer with a direct Internet connection to get the missing value (the one to Office 365 and back).</span></span>  

<span data-ttu-id="16752-363">プロキシから PsPing を実行することを選択した場合、2ミリ秒の値があります。クライアントコンピューターからプロキシサーバーまたは出口ポイント、およびプロキシサーバーから Office 365。</span><span class="sxs-lookup"><span data-stu-id="16752-363">If you choose to run PsPing from the proxy, you'll have two millisecond values: Client computer to proxy server or egress point, and proxy server to Office 365.</span></span> <span data-ttu-id="16752-364">完了しました。</span><span class="sxs-lookup"><span data-stu-id="16752-364">And you're done!</span></span> <span data-ttu-id="16752-365">適切な記録値。</span><span class="sxs-lookup"><span data-stu-id="16752-365">Well, recording values, anyway.</span></span>  

<span data-ttu-id="16752-366">インターネットに直接接続されている別のクライアントコンピューター (プロキシを使用しない) で PsPing を実行すると、2ミリ秒の値があります。クライアントコンピューターは、プロキシサーバーまたは出口ポイント、クライアントコンピューターは Office 365 になります。</span><span class="sxs-lookup"><span data-stu-id="16752-366">If you run PsPing on another client computer that has a direct connection to the Internet, that is, without a proxy, you will have two millisecond values: Client computer to proxy server or egress point, and client computer to Office 365.</span></span> <span data-ttu-id="16752-367">この場合は、クライアントコンピューターの値を [クライアントコンピューター] から [Office 365] に設定し、クライアントコンピューターの RTT 番号をプロキシサーバーまたは出口に、プロキシサーバーまたは出力ポイントから Office 365 に差し引きます (この例を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="16752-367">In this case, subtract the value of client computer to proxy server or egress point from the value of client computer to Office 365, and you will have the RTT numbers from your client computer to the proxy server or egress point, and from proxy server or egress point to Office 365.</span></span>

<span data-ttu-id="16752-368">ただし、直接接続されている影響を受ける場所にクライアントコンピューターがある場合や、プロキシをバイパスする場合は、最初に問題が再現されるかどうかを確認し、それ以降のテストに使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="16752-368">However, if you can find a client computer in the impacted location that is directly connected, or bypasses the proxy, you may choose to see if the issue reproduces there to begin with, and test using it thereafter.</span></span>

<span data-ttu-id="16752-369">待機時間は、Netmon トレースに表示されているように、特定のセッションに十分に余裕がある場合は、これらの追加の時間を増やすことができます。</span><span class="sxs-lookup"><span data-stu-id="16752-369">Latency, as seen in a Netmon trace, those extra milliseconds can add up, if there are enough of them in any given session.</span></span>  

![フレームの概要に Netmon の既定の [時間差] 列が追加された、Netmon の一般的な待ち時間。](media/7ad17380-8527-4bc2-9b9b-6310cf19ba6b.PNG)

> [!NOTE]
> <span data-ttu-id="16752-371">IP アドレスがここに示した ip と異なる場合があります。たとえば、ping では 157.56.0.0/16 または同様の範囲が返されることがあります。</span><span class="sxs-lookup"><span data-stu-id="16752-371">Your IP address may be different than the IPs shown here, for example, your ping may return something more like 157.56.0.0/16 or a similar range.</span></span> <span data-ttu-id="16752-372">Office 365 で使用される範囲の一覧については、「 [office 365 の url と IP アドレスの範囲](https://technet.microsoft.com/library/hh373144.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="16752-372">For a list of ranges used by Office 365, check out [Office 365 URLs and IP address ranges](https://technet.microsoft.com/library/hh373144.aspx).</span></span>

<span data-ttu-id="16752-373">たとえば、132.245 のように検索する場合は、すべてのノードを展開してください (この場合は上部にボタンが表示されます)。</span><span class="sxs-lookup"><span data-stu-id="16752-373">Remember to expand all the nodes (there's a button at the top for this) if you want to search for, for example, 132.245.</span></span>

### <a name="proxy-authentication"></a><span data-ttu-id="16752-374">プロキシ認証</span><span class="sxs-lookup"><span data-stu-id="16752-374">Proxy Authentication</span></span>

<span data-ttu-id="16752-375">これは、プロキシサーバーを使用している場合にのみ適用されます。</span><span class="sxs-lookup"><span data-stu-id="16752-375">This only applies to you if you're going through a proxy server.</span></span> <span data-ttu-id="16752-376">それ以外の場合は、次の手順を省略できます。</span><span class="sxs-lookup"><span data-stu-id="16752-376">If not, you can skip these steps.</span></span> <span data-ttu-id="16752-377">適切に動作している場合は、プロキシ認証が一貫してミリ秒単位で行われる必要があります。</span><span class="sxs-lookup"><span data-stu-id="16752-377">When working properly, proxy authentication should take place in milliseconds, consistently.</span></span> <span data-ttu-id="16752-378">ピーク時の使用期間中に断続的に悪いパフォーマンスが発生しないようにします (例:)。</span><span class="sxs-lookup"><span data-stu-id="16752-378">You shouldn't see intermittent bad performance during peak usage periods (for example).</span></span>  

<span data-ttu-id="16752-379">プロキシ認証がオンになっている場合は、Office 365 への新しい TCP 接続を作成して情報を取得するたびに、認証プロセスをバックグラウンドの背後で通過する必要があります。</span><span class="sxs-lookup"><span data-stu-id="16752-379">If Proxy authentication is on, each time you make a new TCP connection to Office 365 to get information, you need to pass through an authentication process behind the scenes.</span></span> <span data-ttu-id="16752-380">たとえば、予定表から Outlook Online のメールに切り替えると、認証が行われます。</span><span class="sxs-lookup"><span data-stu-id="16752-380">So, for example, when switching from Calendar to Mail in Outlook Online, you will authenticate.</span></span> <span data-ttu-id="16752-381">また、SharePoint Online では、複数のサイトまたは場所からメディアまたはデータがページに表示されると、データをレンダリングするために必要なそれぞれの異なる TCP 接続に対して認証が行われます。</span><span class="sxs-lookup"><span data-stu-id="16752-381">And in SharePoint Online, if a page displays media or data from multiple sites or locations, you will authenticate for each different TCP connection that is needed in order to render the data.</span></span>  

<span data-ttu-id="16752-382">Outlook Online では、予定表とメールボックスを切り替える場合、または SharePoint Online でページ読み込みを遅くする場合に、読み込み時間が長くなることがあります。</span><span class="sxs-lookup"><span data-stu-id="16752-382">In Outlook Online, you may experience slow load times whenever you switch between Calendar and your mailbox, or slow page loads in SharePoint Online.</span></span> <span data-ttu-id="16752-383">ただし、ここには記載されていない他の現象があります。</span><span class="sxs-lookup"><span data-stu-id="16752-383">However, there are other symptoms not listed here.</span></span>

<span data-ttu-id="16752-384">プロキシ認証は、出口プロキシサーバーの設定です。</span><span class="sxs-lookup"><span data-stu-id="16752-384">Proxy authentication is a setting on your egress proxy server.</span></span> <span data-ttu-id="16752-385">Office 365 でパフォーマンスの問題が発生している場合は、ネットワークチームに連絡する必要があります。</span><span class="sxs-lookup"><span data-stu-id="16752-385">If it is causing a performance issue with Office 365, you must consult your networking team.</span></span>  

#### <a name="tools"></a><span data-ttu-id="16752-386">ツール</span><span class="sxs-lookup"><span data-stu-id="16752-386">Tools</span></span>

- <span data-ttu-id="16752-387">Netmon</span><span class="sxs-lookup"><span data-stu-id="16752-387">Netmon</span></span>
- <span data-ttu-id="16752-388">Wireshark</span><span class="sxs-lookup"><span data-stu-id="16752-388">Wireshark</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="16752-389">検索対象</span><span class="sxs-lookup"><span data-stu-id="16752-389">What to look for</span></span>

<span data-ttu-id="16752-390">プロキシ認証は、新しい TCP セッションをスピンアップする必要があるとき、通常はサーバーからのファイルや情報を要求するため、または情報を提供するために行われます。</span><span class="sxs-lookup"><span data-stu-id="16752-390">Proxy authentication takes place whenever a new TCP session must be spun up, commonly to request files or info from the server, or to supply info.</span></span> <span data-ttu-id="16752-391">たとえば、HTTP GET または HTTP POST 要求に対するプロキシ認証が表示されることがあります。</span><span class="sxs-lookup"><span data-stu-id="16752-391">For example, you may see proxy authentication around HTTP GET or HTTP POST requests.</span></span> <span data-ttu-id="16752-392">トレースの要求を認証するフレームを表示する場合は、Netmon および filter に ' NTLMSSP Summary ' 列を追加し `.property.NTLMSSPSummary` ます。</span><span class="sxs-lookup"><span data-stu-id="16752-392">If you want to see the frames where you are authenticating requests in your trace, add the 'NTLMSSP Summary' column to Netmon and filter for  `.property.NTLMSSPSummary`.</span></span> <span data-ttu-id="16752-393">認証にかかった時間を確認するには、[Time Delta] 列を追加します。</span><span class="sxs-lookup"><span data-stu-id="16752-393">To see how long the authentication is taking, add the Time Delta column.</span></span>

<span data-ttu-id="16752-394">Netmon に列を追加するには、次のようにします。</span><span class="sxs-lookup"><span data-stu-id="16752-394">To add a column to Netmon:</span></span>

1. <span data-ttu-id="16752-395">[**説明**] などの列を右クリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-395">Right-click on a column such as **Description**.</span></span>
2. <span data-ttu-id="16752-396">[**列の選択] を**クリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-396">Click **Choose Columns**.</span></span>
3. <span data-ttu-id="16752-397">リスト内で_NTLMSSP の概要_と_時間デルタ_を見つけ、[**追加**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-397">Locate _NTLMSSP Summary_ and _Time Delta_ in the list and click **Add**.</span></span>
4. <span data-ttu-id="16752-398">[_説明_] 列の前または後ろに新しい列を移動して、並べて表示できるようにします。</span><span class="sxs-lookup"><span data-stu-id="16752-398">Move the new columns into place before or behind the _Description_ column so you can read them side-by-side.</span></span>
5. <span data-ttu-id="16752-399">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-399">Click **OK**.</span></span>

<span data-ttu-id="16752-400">列を追加しない場合でも、Netmon フィルターは機能します。</span><span class="sxs-lookup"><span data-stu-id="16752-400">Even if you don't add the column, the Netmon filter will work.</span></span> <span data-ttu-id="16752-401">しかし、どの段階で認証を行うのかを確認できる場合は、トラブルシューティングがより簡単になります。</span><span class="sxs-lookup"><span data-stu-id="16752-401">But your troubleshooting will be much easier if you can see what stage of authentication you're in.</span></span>

<span data-ttu-id="16752-402">プロキシ認証のインスタンスを探す場合は、NTLM チャレンジがあるすべてのフレームを調査するか、認証メッセージが存在することを確認してください。</span><span class="sxs-lookup"><span data-stu-id="16752-402">When looking for instances of Proxy Authentication, be sure to study all frames where there is an NTLM Challenge, or an Authenticate Message is present.</span></span> <span data-ttu-id="16752-403">必要に応じて、特定のトラフィックを右クリックし、[会話 TCP] を探し \> ます。</span><span class="sxs-lookup"><span data-stu-id="16752-403">If necessary, right-click the specific piece of traffic and Find Conversations \> TCP.</span></span> <span data-ttu-id="16752-404">これらの会話の時間差に注意してください。</span><span class="sxs-lookup"><span data-stu-id="16752-404">Be aware of the Time Delta values in these Conversations.</span></span>

![プロキシ認証を示す Netmon トレース。会話別にフィルター処理されます。](media/b640f176-0a52-4bbb-972e-60fb3d6aece2.PNG)

<span data-ttu-id="16752-406">Wireshark に示されているように、プロキシ認証で4秒遅延します。</span><span class="sxs-lookup"><span data-stu-id="16752-406">A four second delay in proxy authentication as seen in Wireshark.</span></span> <span data-ttu-id="16752-407">前に表示されていた**フレーム列からの時間デルタ**は、フレームの詳細にある同じ名前のフィールドを右クリックし、[列として追加] を選択して作成されました。</span><span class="sxs-lookup"><span data-stu-id="16752-407">The **Time delta from previous displayed frame** column was made via right-clicking the field of the same name in the frame details and selecting Add as Column.</span></span>  <br/> <span data-ttu-id="16752-408">![Wireshark では、フレームの詳細で同じ名前のフィールドを右クリックして [列として追加] を選択することで、[前に表示されたフレームからの時間デルタ] 列を作成できます。](media/f5b7bde4-8067-4ee0-bc7f-e9062ce1ba6f.PNG)</span><span class="sxs-lookup"><span data-stu-id="16752-408">![In Wireshark, the 'Time delta from previous displayed frame' column can be made via right-clicking the field of the same name in the frame details and selecting Add as Column.](media/f5b7bde4-8067-4ee0-bc7f-e9062ce1ba6f.PNG)</span></span>

### <a name="dns-performance"></a><span data-ttu-id="16752-409">DNS パフォーマンス</span><span class="sxs-lookup"><span data-stu-id="16752-409">DNS Performance</span></span>

<span data-ttu-id="16752-410">名前解決は、クライアントの国にできるだけ近い場所で実行する場合に、最も適切に動作します。</span><span class="sxs-lookup"><span data-stu-id="16752-410">Name resolution works best and most quickly when it takes place as close to the client's country as possible.</span></span>

<span data-ttu-id="16752-411">DNS 名前解決が海外で行われている場合は、ページの読み込みに秒数を追加することができます。</span><span class="sxs-lookup"><span data-stu-id="16752-411">If DNS name resolution is taking place overseas, it can add seconds to page loads.</span></span> <span data-ttu-id="16752-412">100ミリ秒の下で名前解決が行われるのが理想的です。</span><span class="sxs-lookup"><span data-stu-id="16752-412">Ideally, name resolution happens in under 100ms.</span></span> <span data-ttu-id="16752-413">そうでない場合は、さらに調査する必要があります。</span><span class="sxs-lookup"><span data-stu-id="16752-413">If not, you should do further investigation.</span></span>

> [!TIP]
> <span data-ttu-id="16752-414">Office 365 でクライアント接続がどのように機能するかがわからない場合</span><span class="sxs-lookup"><span data-stu-id="16752-414">Not sure how Client Connectivity works in Office 365?</span></span> <span data-ttu-id="16752-415">[ここ](https://technet.microsoft.com/library/dn741250.aspx)では、「クライアント接続のリファレンス」ドキュメントを見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="16752-415">Take a look at the Client Connectivity Reference document [here](https://technet.microsoft.com/library/dn741250.aspx).</span></span>

#### <a name="tools"></a><span data-ttu-id="16752-416">ツール</span><span class="sxs-lookup"><span data-stu-id="16752-416">Tools</span></span>

- <span data-ttu-id="16752-417">Netmon</span><span class="sxs-lookup"><span data-stu-id="16752-417">Netmon</span></span>
- <span data-ttu-id="16752-418">Wireshark</span><span class="sxs-lookup"><span data-stu-id="16752-418">Wireshark</span></span>
- <span data-ttu-id="16752-419">PsPing</span><span class="sxs-lookup"><span data-stu-id="16752-419">PsPing</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="16752-420">検索対象</span><span class="sxs-lookup"><span data-stu-id="16752-420">What to look for</span></span>

<span data-ttu-id="16752-421">DNS のパフォーマンスの分析は、通常、ネットワークトレースの別のジョブです。</span><span class="sxs-lookup"><span data-stu-id="16752-421">Analyzing DNS performance is typically another job for a network trace.</span></span> <span data-ttu-id="16752-422">ただし、可能性のある原因については、PsPing も役に立ちます。</span><span class="sxs-lookup"><span data-stu-id="16752-422">However, PsPing is also helpful in ruling in, or out, a possible cause.</span></span>

<span data-ttu-id="16752-423">DNS トラフィックは TCP および UDP 要求に基づいており、応答は特定の要求を特定の応答に一致させるために役立つ ID で明確にマークされます。</span><span class="sxs-lookup"><span data-stu-id="16752-423">DNS traffic is based on TCP and UDP requests and responses are clearly marked with an ID that will help to match a specific request with its specific response.</span></span> <span data-ttu-id="16752-424">たとえば、SharePoint Online が web ページでネットワーク名または URL を使用している場合は、DNS トラフィックが表示されます。</span><span class="sxs-lookup"><span data-stu-id="16752-424">You'll see DNS traffic when, for example, SharePoint Online uses a network name or URL on a web page.</span></span> <span data-ttu-id="16752-425">原則として、このトラフィックのほとんどは、ゾーンを転送する場合を除き、UDP 経由で実行されます。</span><span class="sxs-lookup"><span data-stu-id="16752-425">As a rule of thumb, most of this traffic, except when transferring Zones, runs over UDP.</span></span>

<span data-ttu-id="16752-426">Netmon と Wireshark のどちらの場合も、DNS トラフィックを参照できる最も基本的なフィルターは単純 `dns` です。</span><span class="sxs-lookup"><span data-stu-id="16752-426">In both Netmon and Wireshark, the most basic filter that will let you look at DNS traffic is simply `dns`.</span></span> <span data-ttu-id="16752-427">フィルターを指定するときは、小文字を使用してください。</span><span class="sxs-lookup"><span data-stu-id="16752-427">Be sure to use lower case when specifying the filter.</span></span> <span data-ttu-id="16752-428">クライアントコンピューターで問題の再現を始める前に、DNS リゾルバーキャッシュをフラッシュするようにしてください。</span><span class="sxs-lookup"><span data-stu-id="16752-428">Remember to flush your DNS resolver cache before you begin to reproduce the issue on your client computer.</span></span> <span data-ttu-id="16752-429">たとえば、ホームページに対して SharePoint Online のページの読み込みが遅い場合は、すべてのブラウザーを閉じて、新しいブラウザーを開き、トレースを開始し、DNS リゾルバーキャッシュをフラッシュして、SharePoint Online サイトを参照する必要があります。</span><span class="sxs-lookup"><span data-stu-id="16752-429">For example, if you have a slow SharePoint Online page load for the Home page, you should close all browsers, open a new browser, start tracing, flush your DNS resolver cache, and browse to your SharePoint Online site.</span></span> <span data-ttu-id="16752-430">ページ全体が解決されたら、トレースを停止して保存する必要があります。</span><span class="sxs-lookup"><span data-stu-id="16752-430">Once the entire page resolves, you should stop and save the trace.</span></span>

![Netmon の DNS の基本フィルターは DNS です。](media/1bebc118-ca13-45f3-803f-ab73e7af401d.png)

<span data-ttu-id="16752-432">ここで時間のオフセットを確認します。</span><span class="sxs-lookup"><span data-stu-id="16752-432">You want to look at the time offset here.</span></span> <span data-ttu-id="16752-433">また、次の手順を実行して、[ **Time Delta** ] 列を Netmon に追加することもできます。</span><span class="sxs-lookup"><span data-stu-id="16752-433">And it may be helpful to add the **Time Delta** column to Netmon which you can do by completing these steps:</span></span>

1. <span data-ttu-id="16752-434">[**説明**] などの列を右クリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-434">Right-click on a column such as **Description**.</span></span>
2. <span data-ttu-id="16752-435">[**列の選択] を**クリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-435">Click **Choose Columns**.</span></span>
3. <span data-ttu-id="16752-436">一覧で [ _Time Delta_ ] を見つけ、[**追加**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-436">Locate _Time Delta_ in the list and click **Add**.</span></span>
4. <span data-ttu-id="16752-437">[_説明_] 列の前または後ろに新しい列を移動して、並べて表示できるようにします。</span><span class="sxs-lookup"><span data-stu-id="16752-437">Move the new column into place before or behind the _Description_ column so you can read them side-by-side.</span></span>
5. <span data-ttu-id="16752-438">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-438">Click **OK**.</span></span>

<span data-ttu-id="16752-439">目的のクエリが見つかった場合は、[frame details] パネルでそのクエリを右クリックし、[**会話**DNS の検索] を選択して、クエリを分離することを検討してください \> **DNS**。</span><span class="sxs-lookup"><span data-stu-id="16752-439">If you find a query of interest, consider isolating it by right-clicking that query in the frame details panel, choosing **Find Conversations** \> **DNS**.</span></span> <span data-ttu-id="16752-440">[ネットワーク会話] パネルは、UDP トラフィックのログで、特定の会話に直接ジャンプすることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="16752-440">Notice that the Network Conversations panel jumps right to the specific conversation in its log of UDP traffic.</span></span>

![DNS によってフィルター処理された Outlook Online のロードの Netmon トレース、および [会話を検索し、DNS を使用して結果を絞り込む] を使用します。](media/763cf20e-7b48-4a37-9449-c9978cfe118b.PNG)

<span data-ttu-id="16752-442">Wireshark では、DNS 時間の列を作成できます。</span><span class="sxs-lookup"><span data-stu-id="16752-442">In Wireshark you can make a column for DNS time.</span></span> <span data-ttu-id="16752-443">Wireshark および filter by `dns` 、または more helpfully でトレースを取得する (または、トレースを開く) `dns.time` 。</span><span class="sxs-lookup"><span data-stu-id="16752-443">Take your trace (or open a trace) in Wireshark and filter by `dns`, or, more helpfully,  `dns.time`.</span></span> <span data-ttu-id="16752-444">任意の DNS クエリをクリックし、[詳細] が表示されているパネルで、詳細を展開し `Domain Name System (response)` ます。</span><span class="sxs-lookup"><span data-stu-id="16752-444">Click on any DNS query, and, in the panel showing details, expand the  `Domain Name System (response)` details.</span></span> <span data-ttu-id="16752-445">時間 (たとえば、) フィールドが表示し `[Time: 0.001111100 seconds]` ます。</span><span class="sxs-lookup"><span data-stu-id="16752-445">You'll see a field for time (for example, `[Time: 0.001111100 seconds]`.</span></span> <span data-ttu-id="16752-446">この時間を右クリックし、[**列として適用**] を選択します。</span><span class="sxs-lookup"><span data-stu-id="16752-446">Right-click this time and select **Apply as Column**.</span></span> <span data-ttu-id="16752-447">これにより、トレースをすばやく並べ替えることができる**時間**列が表示されます。</span><span class="sxs-lookup"><span data-stu-id="16752-447">This will give you a **Time** column for quicker sorting of your trace.</span></span> <span data-ttu-id="16752-448">[新規] 列をクリックして、値を降順で並べ替え、解決するのに最も時間がかかる DNS 呼び出しを確認します。</span><span class="sxs-lookup"><span data-stu-id="16752-448">Click on the new column to sort by descending values to see which DNS call took the longest to resolve.</span></span>

[<span data-ttu-id="16752-449">Wireshark で (小文字の) dns.time でフィルター処理し、詳細からの時間を列にして昇順で並べ替えた、SharePoint Online の参照。</span><span class="sxs-lookup"><span data-stu-id="16752-449">A browse of SharePoint Online filtered in Wireshark by (lowercase) dns.time, with the time from the details made into a column and sorted ascending.</span></span>](media/1439dcc2-12ff-4ee2-9ef3-1484cf79c384.PNG)

<span data-ttu-id="16752-450">DNS 解決時間の詳細な調査を行う場合は、TCP で使用される DNS ポート (例:) に対して PsPing を試してみてください `psping <IP address of DNS server>:53` 。</span><span class="sxs-lookup"><span data-stu-id="16752-450">If you would like to do more investigation of the DNS resolution time, try a PsPing against the DNS port used by TCP (for example,  `psping <IP address of DNS server>:53`) .</span></span> <span data-ttu-id="16752-451">パフォーマンスの問題が発生している場合もありますか。</span><span class="sxs-lookup"><span data-stu-id="16752-451">Do you still see a performance issue?</span></span> <span data-ttu-id="16752-452">その場合、解決策を実行しようとしている特定の DNS アプリケーションの問題よりも、より広範なネットワークの問題が発生する可能性が高くなります。</span><span class="sxs-lookup"><span data-stu-id="16752-452">If you do, then the problem is more likely to be a broader network issue than an issue of specific the DNS application you're hitting to do resolution.</span></span> <span data-ttu-id="16752-453">また、outlook.office365.com への ping を実行すると、Outlook Online の DNS 名解決が行われていることがわかります (たとえば、outlook-namnorthwest.office365.com)。</span><span class="sxs-lookup"><span data-stu-id="16752-453">It's also worth mentioning, again, that a ping to outlook.office365.com will tell you where DNS name resolution for Outlook Online is taking place (for example, outlook-namnorthwest.office365.com).</span></span>

<span data-ttu-id="16752-454">問題が DNS 固有であると考えられる場合は、IT 部門に連絡して、この問題をさらに詳しく調査するために、DNS 構成と DNS フォワーダーを参照する必要がある場合があります。</span><span class="sxs-lookup"><span data-stu-id="16752-454">If the issue looks to be DNS specific, it may be necessary to contact your IT department to look at DNS configurations and DNS Forwarders to further investigate this issue.</span></span>

### <a name="proxy-scalability"></a><span data-ttu-id="16752-455">プロキシのスケーラビリティ</span><span class="sxs-lookup"><span data-stu-id="16752-455">Proxy Scalability</span></span>

<span data-ttu-id="16752-456">Office 365 の Outlook Online などのサービスは、複数の長期間接続をクライアントに許可します。</span><span class="sxs-lookup"><span data-stu-id="16752-456">Services like Outlook Online in Office 365 grant clients multiple long-term connections.</span></span> <span data-ttu-id="16752-457">そのため、各ユーザーはより長い時間を必要とする接続を使用する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="16752-457">Therefore, each user may use more connections that require a longer life.</span></span>  

#### <a name="tools"></a><span data-ttu-id="16752-458">ツール</span><span class="sxs-lookup"><span data-stu-id="16752-458">Tools</span></span>

<span data-ttu-id="16752-459">数学</span><span class="sxs-lookup"><span data-stu-id="16752-459">Math</span></span>  

#### <a name="what-to-look-for"></a><span data-ttu-id="16752-460">検索対象</span><span class="sxs-lookup"><span data-stu-id="16752-460">What to look for</span></span>

<span data-ttu-id="16752-461">これに固有のネットワークトレースまたはトラブルシューティングツールはありません。</span><span class="sxs-lookup"><span data-stu-id="16752-461">There is no network trace or troubleshooting tool specific to this.</span></span> <span data-ttu-id="16752-462">代わりに、制限およびその他の変数によって帯域幅計算に基づいています。</span><span class="sxs-lookup"><span data-stu-id="16752-462">Instead, it's based upon bandwidth calculations given limitations and other variables.</span></span>  

### <a name="tcp-max-segment-size"></a><span data-ttu-id="16752-463">TCP セグメントの最大サイズ</span><span class="sxs-lookup"><span data-stu-id="16752-463">TCP Max Segment Size</span></span>

<span data-ttu-id="16752-464">SYN SYN/ACK にあります。</span><span class="sxs-lookup"><span data-stu-id="16752-464">Found in the SYN - SYN/ACK.</span></span>  <span data-ttu-id="16752-465">TCP パケットが可能な限り多くのデータを保持するように構成されていることを確認するために、実行したパフォーマンスネットワークトレースを確認してください。</span><span class="sxs-lookup"><span data-stu-id="16752-465">Do this check in any performance network trace you've taken to ensure that TCP packets are configured to carry the maximum amount of data possible.</span></span>

<span data-ttu-id="16752-466">目標は、データの送信についての MSS を1460バイトとして表示することです。</span><span class="sxs-lookup"><span data-stu-id="16752-466">The goal is to see a MSS of 1460 bytes for transmission of data.</span></span> <span data-ttu-id="16752-467">プロキシを使用している場合や、NAT を使用している場合は、このテストをクライアントからプロキシ/出力/NAT に実行し、プロキシ/出力/NAT から Office 365 に対して最適な結果を得られるようにしてください。</span><span class="sxs-lookup"><span data-stu-id="16752-467">If you're behind a proxy, or you are using a NAT, remember to run this test from client to proxy/egress/NAT, and from proxy/egress/NAT to Office 365 for best results!</span></span> <span data-ttu-id="16752-468">これらの TCP セッションは異なります。</span><span class="sxs-lookup"><span data-stu-id="16752-468">These are different TCP sessions.</span></span>

#### <a name="tools"></a><span data-ttu-id="16752-469">ツール</span><span class="sxs-lookup"><span data-stu-id="16752-469">Tools</span></span>

<span data-ttu-id="16752-470">Netmon</span><span class="sxs-lookup"><span data-stu-id="16752-470">Netmon</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="16752-471">検索対象</span><span class="sxs-lookup"><span data-stu-id="16752-471">What to look for</span></span>

<span data-ttu-id="16752-472">TCP 最大セグメントサイズ (MSS) は、ネットワークトレースの3ウェイハンドシェイクのもう1つのパラメーターです。つまり、SYN SYN/ACK パケットに必要なデータを見つけることができます。</span><span class="sxs-lookup"><span data-stu-id="16752-472">TCP Max Segment Size (MSS) is another parameter of the three-way handshake in your network trace, that means you'll find the data you need in the SYN - SYN/ACK packet.</span></span> <span data-ttu-id="16752-473">MSS は実際には非常に簡単に表示されます。</span><span class="sxs-lookup"><span data-stu-id="16752-473">MSS is actually pretty simple to see.</span></span>

<span data-ttu-id="16752-474">任意のパフォーマンスネットワークトレースを開き、興味のある接続を見つけます。または、パフォーマンスの問題を示しています。</span><span class="sxs-lookup"><span data-stu-id="16752-474">Open any performance network trace you have and find the connection you're curious about, or that demonstrates the performance problem.</span></span>

> [!NOTE]
> <span data-ttu-id="16752-475">トレースを見ていて、会話に関連するトラフィックを検索する必要がある場合、クライアントの IP またはプロキシサーバーまたは出口の IP でフィルター処理するか、またはその両方を使用します。</span><span class="sxs-lookup"><span data-stu-id="16752-475">If you are looking at a trace and need to find the traffic relevant to your conversation, filter by the IP of the Client, or the IP of the proxy server or egress point, or both.</span></span> <span data-ttu-id="16752-476">直接送信する場合は、トレースの Office 365 の IP アドレスに対してテストしている URL に対して ping を実行し、フィルター処理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="16752-476">Going directly, you will need to ping the URL that you're testing for the IP address of Office 365 in the trace, and filter by it.</span></span>

<span data-ttu-id="16752-477">2番目のトレースを見ていますか?</span><span class="sxs-lookup"><span data-stu-id="16752-477">Looking at the trace second-hand?</span></span> <span data-ttu-id="16752-478">フィルターを使用して自分の向きを確認してみてください。</span><span class="sxs-lookup"><span data-stu-id="16752-478">Try using filters to orient yourself.</span></span> <span data-ttu-id="16752-479">Netmon で、などの URL に基づいて検索を実行し、 `Containsbin(framedata, ascii, "sphybridExample")` フレーム番号をメモします。</span><span class="sxs-lookup"><span data-stu-id="16752-479">In Netmon, run a search based on the URL, such as `Containsbin(framedata, ascii, "sphybridExample")`, take note of the frame number.</span></span>

<span data-ttu-id="16752-480">Wireshark では、そのようなものを使用 `frame contains "sphybridExample"` します。</span><span class="sxs-lookup"><span data-stu-id="16752-480">In Wireshark use something like  `frame contains "sphybridExample"`.</span></span> <span data-ttu-id="16752-481">リモート Winsock (X-RWS-VERSION) トラフィック (Wireshark で [PSH, ACK] と表示されることがあります) が見つかった場合は、前に説明したように、X-RWS-VERSION の接続が関連する SYN SYN/Ack の前に表示されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="16752-481">If you notice that you've found Remote Winsock (RWS) traffic (it may appear as a [PSH, ACK] in Wireshark), remember that RWS connects can be seen shortly before relevant SYN - SYN/ACKs, as discussed earlier.</span></span>

<span data-ttu-id="16752-482">この時点で、フレーム番号を記録して、フィルターを削除し、Netmon の [ネットワーク会話] ウィンドウで [**すべてのトラフィック**] をクリックして、最も近い SYN を調べることができます。</span><span class="sxs-lookup"><span data-stu-id="16752-482">At this point, you can record the frame number, drop the filter, click **All Traffic** in the Network Conversations window in Netmon to look at the nearest SYN.</span></span>

<span data-ttu-id="16752-483">重要な点として、トレースの時点で IP アドレス情報を受信していない場合は、トレースで URL を検索すると (の一部 `sphybridExample-my.sharepoint.com` )、によってフィルター処理する ip アドレスが提供されます。</span><span class="sxs-lookup"><span data-stu-id="16752-483">Importantly, if you didn't receive any of the IP address information at the time of the trace, finding your URL in the trace (part of `sphybridExample-my.sharepoint.com`, for example), will give you IP addresses to filter by.</span></span>

<span data-ttu-id="16752-484">参照したいトレースの接続を見つけます。</span><span class="sxs-lookup"><span data-stu-id="16752-484">Locate the connection in the trace that you're interested in seeing.</span></span> <span data-ttu-id="16752-485">これを行うには、トレースをスキャンするか、IP アドレスでフィルター処理するか、Netmon の [ネットワーク会話] ウィンドウを使用して特定の会話 Id を選択します。</span><span class="sxs-lookup"><span data-stu-id="16752-485">You may do this by either scanning the trace, by filtering by IP addresses, or by selecting specific Conversation IDs using the Network Conversations window in Netmon.</span></span> <span data-ttu-id="16752-486">SYN パケットを見つけたら、[フレームの詳細] パネルの [TCP] (Netmon)、または [伝送制御プロトコル] (Wireshark) を展開します。</span><span class="sxs-lookup"><span data-stu-id="16752-486">Once you've found the SYN packet, expand TCP (in Netmon), or Transmission Control Protocol (in Wireshark) in the Frame Details panel.</span></span> <span data-ttu-id="16752-487">[TCP オプション] を展開し、MaxSegmentSize します。</span><span class="sxs-lookup"><span data-stu-id="16752-487">Expand TCP Options and MaxSegmentSize.</span></span> <span data-ttu-id="16752-488">関連する SYN-ACK フレームを見つけて、[TCP オプション] と [MaxSegmentSize] を展開します。</span><span class="sxs-lookup"><span data-stu-id="16752-488">Locate the related SYN-ACK frame and Expand TCP Options and MaxSegmentSize.</span></span> <span data-ttu-id="16752-489">2つの値のうち小さい方が、セグメントの最大サイズになります。</span><span class="sxs-lookup"><span data-stu-id="16752-489">The smaller of the two values will be your Maximum Segment Size.</span></span> <span data-ttu-id="16752-490">この図では、「TCP トラブルシューティング」と呼ばれる Netmon の組み込み列を使用しています。</span><span class="sxs-lookup"><span data-stu-id="16752-490">In this picture, I make use of the built-in Column in Netmon called TCP Troubleshoot.</span></span>  

![組み込みの列を使用して、Netmon でフィルター処理されたネットワークトレース。](media/e073df13-71f8-497a-83b4-bb9f70bd9833.PNG)

<span data-ttu-id="16752-492">組み込みの列は、[ **Frame Details** ] パネルの上部にあります。</span><span class="sxs-lookup"><span data-stu-id="16752-492">The built-in column is at the top of the **Frame Details** panel.</span></span> <span data-ttu-id="16752-493">(標準表示に戻るには、[**列**] をもう一度クリックしてから、[**タイムゾーン**] を選択します。)</span><span class="sxs-lookup"><span data-stu-id="16752-493">(To switch back to your normal view, click **Columns** again, and then choose **Time Zone**.)</span></span>

![TCP トラブルシューティング オプション (フレームの概要の最上部) の [列] ドロップダウンの場所。](media/64fd4baa-a872-4f07-b959-752d7d37fd62.PNG)

<span data-ttu-id="16752-495">Wireshark のフィルター処理されたトレースを次に示します。</span><span class="sxs-lookup"><span data-stu-id="16752-495">Here's a filtered trace in Wireshark.</span></span> <span data-ttu-id="16752-496">MSS 値 () に固有のフィルターがあり `tcp.options.mss` ます。</span><span class="sxs-lookup"><span data-stu-id="16752-496">There is a filter specific to the MSS value ( `tcp.options.mss`).</span></span> <span data-ttu-id="16752-497">SYN、SYN/ACK、ACK ハンドシェイクのフレームは、この種の作業を簡単にするために、Wireshark と同等のフレームの詳細 (frame 47 ACK、46 SYN/ACK へのリンク、43 SYN へのリンク) にリンクされています。</span><span class="sxs-lookup"><span data-stu-id="16752-497">The frames of a SYN, SYN/ACK, ACK handshake are linked at the bottom of the Wireshark equivalent to Frame Details (so frame 47 ACK, links to 46 SYN/ACK, links to 43 SYN) to make this kind of work easier.</span></span>

![Wireshark でフィルター処理されたトレースは、最大セグメントサイズ (MSS) の tcp によって設定されます。](media/51e278db-801b-48bc-9b68-87cf92f03fd6.PNG)

<span data-ttu-id="16752-499">選択した**謝辞**(このマトリックスの次のトピック) を確認する必要がある場合は、トレースを閉じないでください。</span><span class="sxs-lookup"><span data-stu-id="16752-499">If you need to check **Selective Acknowledgment** (next topic in this matrix), don't close your trace!</span></span>

### <a name="selective-acknowledgment"></a><span data-ttu-id="16752-500">選択的確認応答</span><span class="sxs-lookup"><span data-stu-id="16752-500">Selective Acknowledgment</span></span>

<span data-ttu-id="16752-501">SYN SYN/ACK にあります。</span><span class="sxs-lookup"><span data-stu-id="16752-501">Found in the SYN - SYN/ACK.</span></span> <span data-ttu-id="16752-502">SYN と SYN/ACK の両方で許可されたとして報告する必要があります。</span><span class="sxs-lookup"><span data-stu-id="16752-502">Must be reported as Permitted in both SYN and SYN/ACK.</span></span> <span data-ttu-id="16752-503">選択的受信確認 (SACK) を使用すると、パケットまたはパケットが失われたときに、データをよりスムーズに再送信できます。</span><span class="sxs-lookup"><span data-stu-id="16752-503">Selective Acknowledgment (SACK) allows for smoother retransmission of data when a packet or packets go missing.</span></span> <span data-ttu-id="16752-504">デバイスでは、この機能を無効にして、パフォーマンスの問題を引き起こすことができます。</span><span class="sxs-lookup"><span data-stu-id="16752-504">Devices can disable this feature, which can lead to performance problems.</span></span>

<span data-ttu-id="16752-505">プロキシを使用している場合や、NAT を使用している場合は、このテストをクライアントからプロキシ/出力/NAT に実行し、プロキシ/出力/NAT から Office 365 に対して最適な結果を得られるようにしてください。</span><span class="sxs-lookup"><span data-stu-id="16752-505">If you're behind a proxy, or you are using a NAT, remember to run this test from client to proxy/egress/NAT, and from proxy/egress/NAT to Office 365 for best results!</span></span> <span data-ttu-id="16752-506">これらの TCP セッションは異なります。</span><span class="sxs-lookup"><span data-stu-id="16752-506">These are different TCP sessions.</span></span>

#### <a name="tools"></a><span data-ttu-id="16752-507">ツール</span><span class="sxs-lookup"><span data-stu-id="16752-507">Tools</span></span>

<span data-ttu-id="16752-508">Netmon</span><span class="sxs-lookup"><span data-stu-id="16752-508">Netmon</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="16752-509">検索対象</span><span class="sxs-lookup"><span data-stu-id="16752-509">What to look for</span></span>

<span data-ttu-id="16752-510">セレクティブ肯定応答 (SACK) は、SYN SYN/ACK ハンドシェイクのもう1つのパラメーターです。</span><span class="sxs-lookup"><span data-stu-id="16752-510">Selective Acknowledgment (SACK) is another parameter in the SYN-SYN/ACK handshake.</span></span> <span data-ttu-id="16752-511">SYN SYN/ACK のトレースをフィルター処理することができます。</span><span class="sxs-lookup"><span data-stu-id="16752-511">You can filter your trace for SYN - SYN/ACK many ways.</span></span>

<span data-ttu-id="16752-512">トレースをスキャンするか、IP アドレスでフィルター処理するか、または Netmon の [ネットワーク会話] ウィンドウを使用して会話 ID をクリックして、表示されているトレースで接続を見つけます。</span><span class="sxs-lookup"><span data-stu-id="16752-512">Locate the connection in the trace that you're interested in seeing either by scanning the trace, filtering by IP addresses, or by clicking a Conversation ID using the Network Conversations window in Netmon.</span></span> <span data-ttu-id="16752-513">SYN パケットが見つかったら、Netmon の [TCP] を展開するか、または Wireshark の伝送制御プロトコルを [フレームの詳細] セクションで展開します。</span><span class="sxs-lookup"><span data-stu-id="16752-513">Once you've found the SYN packet, expand TCP in Netmon, or Transmission Control Protocol in Wireshark in the Frame Details section.</span></span> <span data-ttu-id="16752-514">[TCP オプション] を展開し、[SACK] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="16752-514">Expand TCP Options and then SACK.</span></span> <span data-ttu-id="16752-515">関連する SYN-ACK フレームを見つけ、[TCP オプション] と [SACK] フィールドを展開します。</span><span class="sxs-lookup"><span data-stu-id="16752-515">Locate the related SYN-ACK frame and Expand TCP Options and its SACK field.</span></span> <span data-ttu-id="16752-516">SYN と SYN/ACK の両方で特定の SACK が許可されるようにします。</span><span class="sxs-lookup"><span data-stu-id="16752-516">Make certain SACK is permitted in both SYN and SYN/ACK.</span></span> <span data-ttu-id="16752-517">次に、Netmon と Wireshark の両方に表示される SACK 値を示します。</span><span class="sxs-lookup"><span data-stu-id="16752-517">Here are SACK values as seen in both Netmon and Wireshark.</span></span>

![Tcp の結果として Netmon のセレクティブ肯定 (SACK)。フラグは1です。](media/216f556f-5031-4ed2-b066-a0d9b3251fa2.PNG)

![Wireshark に表示されるとおり、tcp.flags.syn == 1 でフィルター処理された SACK。](media/0a6e26e5-43dc-403b-adc9-3349a55f4e4b.PNG)

### <a name="dns-geolocation"></a><span data-ttu-id="16752-520">DNS 地理位置情報</span><span class="sxs-lookup"><span data-stu-id="16752-520">DNS Geolocation</span></span>

<span data-ttu-id="16752-521">世界中の Office 365 で DNS 呼び出しの解決が試行される場所は、接続速度に影響します。</span><span class="sxs-lookup"><span data-stu-id="16752-521">Where in the world Office 365 tries to resolve your DNS call effects your connection speed.</span></span>

<span data-ttu-id="16752-522">Outlook Online では、最初の DNS 参照が完了した後、その DNS の場所が最も近いデータセンターへの接続に使用されます。</span><span class="sxs-lookup"><span data-stu-id="16752-522">In Outlook Online, after the first DNS lookup is completed, the location of that DNS will be used to connect to your nearest datacenter.</span></span> <span data-ttu-id="16752-523">Outlook Online CAS サーバーに接続します。これにより、バックボーンネットワークを使用してデータが格納されているデータセンター (dC) に接続します。</span><span class="sxs-lookup"><span data-stu-id="16752-523">You will be connected to an Outlook Online CAS server, which will use the backbone network to connect to the datacenter (dC) where your data is stored.</span></span> <span data-ttu-id="16752-524">これは速くなります。</span><span class="sxs-lookup"><span data-stu-id="16752-524">This is faster.</span></span>

<span data-ttu-id="16752-525">SharePoint Online にアクセスすると、海外で出張するユーザーは、その active データセンターに送られます。これは、場所が SPO テナントの基礎に基づいている dC (米国の場合は米国のユーザーがいる場合は米国の dC) になります。</span><span class="sxs-lookup"><span data-stu-id="16752-525">When accessing SharePoint Online, a user traveling abroad will be directed to their active datacenter -- that's the dC whose location is based on their SPO tenant's home-base (so, a dC in the USA if the user if USA-based).</span></span>

<span data-ttu-id="16752-526">Lync online には、一度に複数の dC にアクティブなノードがあります。</span><span class="sxs-lookup"><span data-stu-id="16752-526">Lync online has active nodes in more than one dC at a time.</span></span> <span data-ttu-id="16752-527">Lync online インスタンスに対する要求が送信されると、Microsoft の DNS は世界中の要求元の場所を特定し、Lync online がアクティブな地域の最も近い dC から IP アドレスを返します。</span><span class="sxs-lookup"><span data-stu-id="16752-527">When requests are sent for Lync online instances, Microsoft's DNS will determine where in the world the request came from, and return IP addresses from the nearest regional dC where Lync online is active.</span></span>

> [!TIP]
> <span data-ttu-id="16752-528">クライアントが Office 365 に接続する方法について詳しく知る必要がありますか?</span><span class="sxs-lookup"><span data-stu-id="16752-528">Need to know more about how clients connect to Office 365?</span></span> <span data-ttu-id="16752-529">[クライアント接続](https://technet.microsoft.com/library/dn741250.aspx)のリファレンスの記事 (およびその役に立つグラフィックス) を見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="16752-529">Take a look at the [Client Connectivity](https://technet.microsoft.com/library/dn741250.aspx) reference article (and its helpful graphics).</span></span>

#### <a name="tools"></a><span data-ttu-id="16752-530">ツール</span><span class="sxs-lookup"><span data-stu-id="16752-530">Tools</span></span>

- <span data-ttu-id="16752-531">コマンド</span><span class="sxs-lookup"><span data-stu-id="16752-531">Ping</span></span>
- <span data-ttu-id="16752-532">PsPing</span><span class="sxs-lookup"><span data-stu-id="16752-532">PsPing</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="16752-533">検索対象</span><span class="sxs-lookup"><span data-stu-id="16752-533">What to look for</span></span>

<span data-ttu-id="16752-534">多くの場合、クライアントの DNS サーバーから Microsoft の DNS サーバーへの名前解決の要求は、Microsoft DNS が地域データセンターの IP アドレス (dC) を返す結果となることがあります。</span><span class="sxs-lookup"><span data-stu-id="16752-534">Requests for name resolution from the client's DNS servers to Microsoft's DNS servers should in most cases result in Microsoft DNS returning the IP address of a regional datacenter (dC).</span></span> <span data-ttu-id="16752-535">これは何を意味するのでしょうか。</span><span class="sxs-lookup"><span data-stu-id="16752-535">What does this mean for you?</span></span> <span data-ttu-id="16752-536">本社が Bangalore、インドに居住しているのに、米国では、ブラウザーが Outlook Online を要求している場合、Microsoft の DNS サーバーは米国の地域データセンターの IP アドレスをデータセンターに渡す必要があります。</span><span class="sxs-lookup"><span data-stu-id="16752-536">If your headquarters are in Bangalore, India, but you are traveling in the United States, when your browser makes a request for Outlook Online, Microsoft's DNS servers should hand you IP addresses to datacenters in the United States -- a regional datacenter.</span></span> <span data-ttu-id="16752-537">Outlook からメールが必要な場合、データはデータセンター間の Microsoft の高速バックボーンネットワークを介して転送されます。</span><span class="sxs-lookup"><span data-stu-id="16752-537">If mail is needed from Outlook, that data will travel across Microsoft's quick backbone network between the datacenters.</span></span>

<span data-ttu-id="16752-538">DNS は、名前解決がユーザーの場所の近くで可能な限り速く実行されると、最速に機能します。</span><span class="sxs-lookup"><span data-stu-id="16752-538">DNS works fastest when name resolution is done as close to the user location as possible.</span></span> <span data-ttu-id="16752-539">ヨーロッパでは、ヨーロッパの Microsoft DNS にアクセスし、(理想的には) ヨーロッパのデータセンターを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="16752-539">If you're in Europe, you want to go to a Microsoft DNS in Europe, and (ideally) deal with a datacenter in Europe.</span></span> <span data-ttu-id="16752-540">ヨーロッパのクライアントから DNS への移行と、アメリカのデータセンターのパフォーマンスは低下します。</span><span class="sxs-lookup"><span data-stu-id="16752-540">Performance from a client in Europe going to DNS and a datacenter in America will be slower.</span></span>

<span data-ttu-id="16752-541">Outlook.office365.com に対して Ping ツールを実行して、世界中の DNS 要求がルーティングされている場所を特定します。</span><span class="sxs-lookup"><span data-stu-id="16752-541">Run the Ping tool against outlook.office365.com to determine where in the world your DNS request is being routed.</span></span> <span data-ttu-id="16752-542">ヨーロッパの場合は、outlook-emeawest.office365.com のような応答が表示されます。</span><span class="sxs-lookup"><span data-stu-id="16752-542">If you are in Europe, you should see a reply from something like outlook-emeawest.office365.com.</span></span> <span data-ttu-id="16752-543">南北アメリカでは、outlook-namnorthwest.office365.com のようなものが期待されます。</span><span class="sxs-lookup"><span data-stu-id="16752-543">In the Americas, expect something like outlook-namnorthwest.office365.com.</span></span>

<span data-ttu-id="16752-544">クライアントコンピューターでコマンドプロンプトを開きます (Start \> Run \> cmd または Windows キー \> タイプ cmd を使用)。</span><span class="sxs-lookup"><span data-stu-id="16752-544">Open the command prompt on the client computer (via Start \> Run \> cmd or Windows key \> type cmd).</span></span> <span data-ttu-id="16752-545">「Ping outlook.office365.com」と入力し、ENTER キーを押します。</span><span class="sxs-lookup"><span data-stu-id="16752-545">Type ping outlook.office365.com and press ENTER.</span></span> <span data-ttu-id="16752-546">IPv4 経由で ping を実行するように指定する場合は、-4 を指定することを忘れないでください。</span><span class="sxs-lookup"><span data-stu-id="16752-546">Remember, to specify -4 if you want to specify to ping via IPv4.</span></span> <span data-ttu-id="16752-547">ICMP パケットから応答を取得できない場合がありますが、要求がルーティングされた DNS の名前が表示されるはずです。</span><span class="sxs-lookup"><span data-stu-id="16752-547">You may fail to get a reply from the ICMP packets, but you should see the name of the DNS to which the request was routed.</span></span> <span data-ttu-id="16752-548">この接続の待機時間数を確認するには、ping によって返されるサーバーの IP アドレスに PsPing を試行します。</span><span class="sxs-lookup"><span data-stu-id="16752-548">If you want to see the latency numbers for this connection try PsPing to the IP address of the server that is returned by ping.</span></span>  

![outlook-namnorthwest の解決を示す、outlook.office365.com に対する Ping。](media/06c944d5-6159-43ec-aa31-757770695e8b.PNG)

![Ping によって返される IP アドレスへの PSPing は、平均28ミリ秒の待機時間を示します。 outlook.office365.com。](media/f2b25a75-1a87-4479-b8a7-fa4375683507.PNG)

### <a name="office-365-application-troubleshooting"></a><span data-ttu-id="16752-551">Office 365 アプリケーションのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="16752-551">Office 365 Application Troubleshooting</span></span>

#### <a name="tools"></a><span data-ttu-id="16752-552">ツール</span><span class="sxs-lookup"><span data-stu-id="16752-552">Tools</span></span>

- <span data-ttu-id="16752-553">Netmon</span><span class="sxs-lookup"><span data-stu-id="16752-553">Netmon</span></span>
- <span data-ttu-id="16752-554">HTTPWatch</span><span class="sxs-lookup"><span data-stu-id="16752-554">HTTPWatch</span></span>
- <span data-ttu-id="16752-555">ブラウザーの F12 コンソール</span><span class="sxs-lookup"><span data-stu-id="16752-555">F12 Console in the browser</span></span>

<span data-ttu-id="16752-556">このネットワーク固有の記事では、アプリケーション固有のトラブルシューティングで使用されるツールについては説明しません。</span><span class="sxs-lookup"><span data-stu-id="16752-556">We don't cover tools used in application-specific troubleshooting in this network-specific article.</span></span> <span data-ttu-id="16752-557">しかし、[このページで](https://support.office.com/article/Network-planning-and-performance-tuning-for-Office-365-e5f1228c-da3c-4654-bf16-d163daee8848)使用*できる*リソースがわかります。</span><span class="sxs-lookup"><span data-stu-id="16752-557">But you'll find resources you  *can*  use [on this page](https://support.office.com/article/Network-planning-and-performance-tuning-for-Office-365-e5f1228c-da3c-4654-bf16-d163daee8848).</span></span>

## <a name="related-topics"></a><span data-ttu-id="16752-558">関連項目</span><span class="sxs-lookup"><span data-stu-id="16752-558">Related Topics</span></span>

[<span data-ttu-id="16752-559">Office 365 エンドポイントの管理</span><span class="sxs-lookup"><span data-stu-id="16752-559">Managing Office 365 endpoints</span></span>](https://support.office.com/article/99cab9d4-ef59-4207-9f2b-3728eb46bf9a)
  
[<span data-ttu-id="16752-560">Office 365 エンドポイントの FAQ</span><span class="sxs-lookup"><span data-stu-id="16752-560">Office 365 endpoints FAQ</span></span>](https://support.office.com/article/d4088321-1c89-4b96-9c99-54c75cae2e6d)
