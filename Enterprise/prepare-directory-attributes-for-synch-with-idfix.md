---
title: IdFix ツールを使用して Office 365 と同期するためにディレクトリ属性を準備する
ms.author: robmazz
author: robmazz
manager: laurawi
ms.date: 8/21/2018
ms.audience: Admin
ms.topic: article
ms.service: o365-administration
localization_priority: Normal
ms.custom: Adm_O365
ms.collection:
- Ent_O365
- M365-identity-device-management
search.appverid:
- MET150
- MOE150
ms.assetid: 497593cf-24c6-491c-940b-7c86dcde9de0
description: idfix を使用して、Office 365 に同期する前に社内ディレクトリを準備し、クリーンアップする方法について説明します。
ms.openlocfilehash: cdfee8178f731d20c799f550d1dacb0a04a72cae
ms.sourcegitcommit: 1b6ba4043497c27b3a89689766b975f2405e0ec8
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/19/2019
ms.locfileid: "30085096"
---
# <a name="prepare-directory-attributes-for-synchronization-with-office-365-by-using-the-idfix-tool"></a>IdFix ツールを使用して Office 365 と同期するためにディレクトリ属性を準備する
このトピックでは、idfix ツールの実行方法、発生する可能性のある一般的なエラー、推奨される修正、例、および多数のエラーが発生した場合の対処に関するベストプラクティスについて説明します。
  
## <a name="fixing-errors-in-your-directory-by-using-the-idfix-gui"></a>IdFix GUI を使用したディレクトリ内のエラーの修正
[Office 365 idfix ツールを実行](install-and-run-idfix.md)して、ディレクトリ内の問題を検索し、このトピックで説明されているように GUI でエラーを修正します。ツールによって空のテーブルが返された場合、エラーは検出されませんでした。ディレクトリに多くの問題がある場合は、ツールがエラーを返したときに過剰な問題が発生する可能性があります。これを解決する1つの方法は、1つの型のすべてのエラーを修正してから、次の種類に進むことです。 
  
1. 変更を加え始める前に、IdFix によって提示される推奨事項を確認してください。
    
2. IdFix が返すエラーのリストを概観します。エラーの種類がリストされている列の先頭にある **[ERROR]** をクリックすると、エラーの種類ごとにエラーを並び替えることができます。複数のエラーが 1 つの属性に関連付けられている場合、複数のエラーが 1 つの行に結合されます。IdFix は、**[UPDATE]** 列に可能な限り修正の推奨事項を示します。この修正は、オブジェクトに関連付けられているその他の属性のチェックに基づいています。これらは、ディレクトリに既に存在するものよりも通常良いものですが、実際にどちらが適しているかを判断できるのはユーザーだけです。 
    
3. idfix で重複エラーを修正するための提案がある場合、修正は、[**更新**] 列の値の先頭にある3つのフラグのいずれかによっ`[E]john.doe@contoso.com`て識別されます (例:)。提案を承諾した場合、変更を適用すると、フラグはディレクトリに挿入されません。候補フラグの後の値のみが適用されます (例`john.doe@contoso.com`:)。提案を承諾する場合は、[**アクション**] 列の [照合する] アクションを選択します。flags は、次のようなアクションを示します。 
    
 - **[C]** 提案されているアクションは **[COMPLETE]** です。値を編集する必要はありません。
    
 - **[E]** 提案されているアクションは **[EDIT]** です。値は、ディレクトリ内の別の値との競合を避けるために変更する必要があります。
    
 - **[R]** 提案されているアクションは **[REMOVE]** です。たとえば、この値はメールが有効になっていないオブジェクト上の SMTP プロキシであり、安全に削除できる可能性があります。
    
4. エラーを読んで理解した後、変更内容で [**更新**] 列のエントリを更新し、[**アクション**] 列で変更を実装するために idfix を実行する対象を選択します。たとえば、2人のユーザーが重複`proxyAddress`を識別している可能性があります。メール配信には、 `proxyAddress` 1 人のユーザーしか使用できません。この問題を解決するには、 **** ユーザーの [**アクション**] 列の値を適切に設定し、他のユーザーに対して [**アクション**] 列の**削除**をマークします。これにより`proxyAddress` 、これ`proxyAddress` `proxyAddress`が属していないユーザーの属性が削除され、そのユーザーに対して適切な変更を行うことはできません。
    
## <a name="common-errors-and-fixes-detected-by-idfix"></a>IdFix によって検出される一般的なエラーおよび修正
次の表は、IdFix によって検出されるエラーと、ツールによって提案される最も一般的な修正を示しています。一部のエラーには、修正方法の例も記載されています。

|**エラー**|**エラーの種類の説明**|**提案される修正**|**例**|
|:-----|:-----|:-----|:-----|
|**character** | 無効な文字。値に無効な文字が含まれています。 | **[UPDATE]** 列に示されるエラーに関する提案修正には、無効な文字を削除した値が表示されます。  <br/> | 有効なメールアドレスの末尾にある末尾のスペースは、次の例のような無効な文字です。  <br/> " `user@contoso.com` "  <br/> 有効なメールアドレスの先頭にある先頭のスペースは、次の例のような無効な文字です。  <br/> " ` user@contoso.com `"  <br/>  `ú`文字が無効な文字です。 |
|**duplicate** | 重複項目。値は、照会のスコープ内で重複しています。すべての重複値が、エラーとして表示されます。 | 値を編集または削除して、重複を排除します。ツールは、重複に対しては提案修正を示しません。代わりに、ユーザーが複数の重複値のうちどれが正しい値かを選択し、重複項目を削除する必要があります。 ||
|**format** | 形式設定エラー。値が、属性の使用方法に関する形式の要件に違反しています。 | 提案される [UPDATE] には、無効な文字が削除された値が示されます。無効な文字がない場合には、[UPDATE] と [Value] の表示内容は同じです。[UPDATE] の内容を判断は、ユーザーが行う必要があります。ツールは、すべての形式設定エラーに関して提案修正を示すわけではありません。 | たとえば、SMTP アドレスは RFC 2822 に準拠している必要があります。また、mailNickName をピリオドで開始または終了することはできません。ディレクトリ属性の形式要件の詳細については、「 [Prepare to プロビジョニングユーザーによる Office 365 へのディレクトリ同期を準備する](prepare-for-directory-synchronization.md)」の「ディレクトリオブジェクトと属性の準備」を参照してください。 |
|topleveldomain  <br/> |トップレベルのドメイン。これは、 [RFC 2822](https://go.microsoft.com/fwlink/p/?LinkId=401464)の書式設定に従う値に適用されます。最上位のドメインがインターネットにルーティングできない場合は、エラーとして識別されます。たとえば、. ローカルで終わる SMTP アドレスは、インターネットにルーティングできないため、このエラーが発生します。 |値を、 `.com`または`.net`などのインターネットルーティング可能なドメインに変更します。 | また`myaddress@fourthcoffee.local`は`fourthcoffee.com`別のインターネットルーティング可能なドメインに変更します。  <br/> 手順については、「[ルーティング不能なドメイン (たとえば、ローカルドメイン) をディレクトリ同期用に準備する方法](prepare-a-non-routable-domain-for-directory-synchronization.md)」を参照してください。 |
|**domainpart** | ドメイン部エラー。これは、RFC 2822 形式設定の対象となる値に当てはまります。値のドメイン部が無効で RFC 2822 に準拠していない場合に、このエラーが生成されます。 | 値を RFC 2822 に準拠する値に変更します。たとえば、スペースまたは無効な文字が含まれていないことを確認してください。 | を`myaddress@fourth coffee.com`に`myaddress@fourthcoffee.com`変更します。 |
|**domainpart_localpart** | ローカル部エラー。これは、RFC 2822 形式設定の対象となる値に当てはまります。値のローカル部が無効で RFC 2822 に準拠していない場合に、このエラーが生成されます。 |値を RFC 2822 に準拠する値に変更します。たとえば、スペースまたは無効な文字が含まれていないことを確認してください。 |を`my"work"address@fourthcoffee.com`に`myworkaddress@fourthcoffee.com`変更します。 |
|**length** | 長さエラー。値が、属性の長さの制限に違反します。これは通常、ディレクトリ スキーマが変更されたときに生じます。  | IdFix によって提案される更新内容では、許容される長さに値が切り捨てられます。  <br/> これにより、望ましくない結果が生じる場合もあることに注意してください。提案修正を確認し、**[Apply]** をクリックする前に必要な変更を加えてください。 ||
|**blank**  | 空白または null エラー。値が、属性を同期するための null 制限に違反します。いくつかの属性には値が含まれている必要があります。 | 可能な場合、提案される更新内容では、他の属性値を用いて同様の代替値が生成されます。 ||
|**mailmatch** | これは、Office 365 専用のみに適用されます。値が mail 属性と一致しません。 | 推奨される更新プログラムは、"SMTP:" で始まるメール属性値になります。 ||
    
## <a name="operations-you-can-perform-by-using-idfix"></a>IdFix を使用して実行できる操作
エラーを修正するには、[**アクション**] ドロップダウンリストからオプションを選択します。次の表では、idfix ツールを使用して属性に対して実行できる**操作**操作について説明します。[**アクション**] 列を空のままにしておくと、idfix ツールでは、ディレクトリ内の特定のエラーに対する操作は実行されません。 

|**ACTION**|**アクションの説明**|**例**|
|:-----|:-----|:-----|
|**COMPLETE** | 元の値は受け入れ可能であり、エラーとして識別されていても変更しません。 | 2 人のユーザーの proxyAddress が重複していると識別されました。1 人だけがメール配信用にその値を使用できます。適切な値を持つユーザーには **[COMPLETE]** のマークを付けます。 |
|**REMOVE** | 属性の値は、ソースオブジェクトから削除されます。たとえば、 `proxyAddresses`複数値属性の場合は、表示されている個々の値のみが削除されます。 | 2 人のユーザーの proxyAddress が重複していると識別されました。1 人だけがメール配信用にその値を使用できます。重複値を持つユーザーに **[REMOVE]** のマークを付けます。 |
|**修正** | [**更新**] 列の情報は、属性値を変更するために使用されます。有効な**更新プログラム**の値が idfix によって提案されている場合は、[**アクション**] 列から [**編集**] を選択し、次のエラーに進みます。提案が気に入らない場合は、[**更新**] 列に新しい候補を入力し、[**アクション**] 列で [**編集**] を選択します。 ||
|**操作** | このオプションは、トランザクション ログから復元した場合にのみ使用可能です。**[UNDO]** を選択した場合、属性値は元の値に復元されます。 ||
|**FAIL** | この値は、**更新**値が AD DS ルールとの間で不明な競合を持っている場合にのみ返されます。この場合、エラーの内容がわかっていれば、[**更新**] 列の値をもう一度編集できます。ADSI エディターを使用して、オブジェクトの値を分析する必要がある場合があります。詳細については、「 [ADSI edit (adsiedit)](https://go.microsoft.com/fwlink/p/?LinkId=401170)」を参照してください。 ||

特定のエラーまたは一連のエラーに関して **[ACTION]** を選択した後、**[Apply]** をクリックします。**[Apply]** をクリックすると、ツールによってディレクトリに変更が加えられます。**[Apply]** をクリックする前に複数のエラーを修正すると、IdFix によって同時にすべてが変更されます。

idfix を再度実行して、修正によって新しいエラーが発生しなかったことを確認します。必要な回数だけこれらの手順を繰り返すことができます。同期する前に、このプロセスを何度か実行することをお勧めします。
    
## <a name="changing-the-rule-set-used-by-idfix"></a>IdFix で使用するルール セットの変更
既定では、idfix はマルチテナントルールセットを使用して、ディレクトリ内のエントリをテストします。これは、ほとんどの Office 365 = お客様のための適切なルールセットです。ただし、Office 365 専用または ITAR (肘掛けされた国際トラフィック) のお客様の場合は、idfix を構成して、代わりに専用のルールセットを使用することができます。お客様の種類がわからない場合は、この手順を省略しても問題ありません。ルールセットを専用に設定するには、メニューバーの歯車アイコンをクリックして、[**専用**] をクリックします。
  
## <a name="changing-the-scope-of-the-search-used-by-idfix"></a>IdFix で使用する検索スコープの変更
既定では、IdFix は、ディレクトリ全体を検索します。必要な場合には、代わりに、ツールが特定のサブツリーを検索するように構成できます。そのためには、メニュー バーで、[Filter] アイコンをクリックし、有効なサブツリーを入力してください。
  
## <a name="rolling-back-your-changes-by-using-the-idfix-gui"></a>IdFix GUI による変更内容のロールバック
[**適用**] をクリックして変更を適用するたびに、idfix ツールは、加えた変更を一覧表示するトランザクションログと呼ばれる個別のファイルを作成します。トランザクションログを使用して、誤った変更を行った場合に最新のログに含まれていた変更のみをロールバックすることができます。更新中に間違いを犯した場合は、[**元に戻す**] をクリックすると、最近適用した変更を元に戻すことができます。[元に**戻す**] をクリックすると、idfix は、トランザクションログを使用して、最新のトランザクションログにある変更のみをロールバックします。トランザクションログの使用の詳細については、「 [Reference: Office 365 idfix トランザクションログ](idfix-transaction-log.md)」を参照してください。